(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(e,t,r){"use strict";r.r(t),function(e){var t=r(4),n=r(3),i=r(5),a=(r(6),r(7));e.THREE=i;const o=.0025,s=64,u=1.2;setTimeout(()=>{try{window.pageApp=new l(document.getElementById("target"))}catch(e){console.error("page error",e)}},1e3);class l extends a.a{constructor(e){super(e,!1),this._tapEventData=null,this.el.addEventListener("touchstart",this._onTouchStart.bind(this),!1),this.universe=n.b.new(s,s),this.board=new i.Group,this.cells=[];const t=o*u,r=s*t/2;for(let e=0;e<s;e++){this.cells.push([]);for(let n=0;n<s;n++){const a=new i.BoxGeometry(o,o,o),s=new i.MeshNormalMaterial,u=new i.Mesh(a,s);u.position.set(t*e-r,0,t*n-r),this.cells[e].push(u),this.board.add(u)}}this.board.geometry.rotate(Math.PI/2)}async updateScene(e){this.universe.tick();const r=s,i=s,a=new Uint8Array(t.b.buffer,this.universe.cells(),r*i);for(let e=0;e<i;e++)for(let t=0;t<r;t++){const i=a[e*r+t]===n.a.Dead;this.cells[e][t].material.opacity=i?0:1}if(null===this._tapEventData)return;const o=this._tapEventData[0],u=this._tapEventData[1];this._tapEventData=null;const l=await e.findAnchor(o,u);null!==l&&(this.removeAnchoredNode(this.board),this.addAnchoredNode(l,this.board))}_onTouchStart(t){t.touches&&0!==t.touches.length?this._tapEventData=[t.touches[0].clientX/e.innerWidth,t.touches[0].clientY/e.innerHeight]:console.error("No touches on touch event",t)}}}.call(this,r(2))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l}));var n=r(4);let i=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),a=null;function o(e,t){return i.decode((null!==a&&a.buffer===n.b.buffer||(a=new Uint8Array(n.b.buffer)),a).subarray(e,e+t))}const s=Object.freeze({Dead:0,Alive:1});class u{static __wrap(e){const t=Object.create(u.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,n.a(e)}static new(e,t){const r=n.d(e,t);return u.__wrap(r)}cells(){return n.c(this.ptr)}tick(){n.e(this.ptr)}}const l=function(e,t){throw new Error(o(e,t))}},function(e,t,r){"use strict";var n=r.w[e.i];e.exports=n;r(3);n.f()},,function(e,t){void 0!==navigator.xr&&("undefined"!=typeof XRDisplay&&(XRDisplay=null),"undefined"!=typeof XRSession&&(XRSession=null),"undefined"!=typeof XRSessionCreateParameters&&(XRSessionCreateParameters=null),"undefined"!=typeof Reality&&(Reality=null),"undefined"!=typeof XRPointCloud&&(XRPointCloud=null),"undefined"!=typeof XRLightEstimate&&(XRLightEstimate=null),"undefined"!=typeof XRAnchor&&(XRAnchor=null),"undefined"!=typeof XRPlaneAnchor&&(XRPlaneAnchor=null),"undefined"!=typeof XRFaceAnchor&&(XRFaceAnchor=null),"undefined"!=typeof XRImageAnchor&&(XRImageAnchor=null),"undefined"!=typeof XRAnchorOffset&&(XRAnchorOffset=null),"undefined"!=typeof XRStageBounds&&(XRStageBounds=null),"undefined"!=typeof XRStageBoundsPoint&&(XRStageBoundsPoint=null),"undefined"!=typeof XRPresentationFrame&&(XRPresentationFrame=null),"undefined"!=typeof XRView&&(XRView=null),"undefined"!=typeof XRViewport&&(XRViewport=null),"undefined"!=typeof XRCoordinateSystem&&(XRCoordinateSystem=null),"undefined"!=typeof XRViewPose&&(XRViewPose=null),"undefined"!=typeof XRLayer&&(XRLayer=null),"undefined"!=typeof XRWebGLLayer&&(XRWebGLLayer=null),"undefined"!=typeof XRVideoFrame&&(XRVideoFrame=null)),function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=25)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),o=(n=a)&&n.__esModule?n:{default:n};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"mat4_generateIdentity",value:function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},{key:"mat4_get_position",value:function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}},{key:"mat4_get_rotation",value:function(e,t){var r=new o.default;return r.setFromRotationMatrix(t),e[0]=r.x,e[1]=r.y,e[2]=r.z,e[3]=r.w,e}},{key:"mat4_eyeView",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Float32Array([0,0,0]);e.mat4_translate(t,r,n),e.mat4_invert(t,t)}},{key:"mat4_perspectiveFromFieldOfView",value:function(t,r,n,i){var a=Math.tan(r.upDegrees*e.PI_OVER_180),o=Math.tan(r.downDegrees*e.PI_OVER_180),s=Math.tan(r.leftDegrees*e.PI_OVER_180),u=Math.tan(r.rightDegrees*e.PI_OVER_180),l=2/(s+u),h=2/(a+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(s-u)*l*.5,t[9]=(a-o)*h*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}},{key:"mat4_fromRotationTranslation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,u=i+i,l=a+a,h=n*s,c=n*u,f=n*l,d=i*u,_=i*l,p=a*l,v=o*s,y=o*u,m=o*l;return e[0]=1-(d+p),e[1]=c+m,e[2]=f-y,e[3]=0,e[4]=c-m,e[5]=1-(h+p),e[6]=_+v,e[7]=0,e[8]=f+y,e[9]=_-v,e[10]=1-(h+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}},{key:"mat4_translate",value:function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,u=void 0,l=void 0,h=void 0,c=void 0,f=void 0,d=void 0,_=void 0,p=void 0,v=void 0,y=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],u=t[2],l=t[3],h=t[4],c=t[5],f=t[6],d=t[7],_=t[8],p=t[9],v=t[10],y=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=l,e[4]=h,e[5]=c,e[6]=f,e[7]=d,e[8]=_,e[9]=p,e[10]=v,e[11]=y,e[12]=o*n+h*i+_*a+t[12],e[13]=s*n+c*i+p*a+t[13],e[14]=u*n+f*i+v*a+t[14],e[15]=l*n+d*i+y*a+t[15]),e}},{key:"mat4_invert",value:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=t[9],f=t[10],d=t[11],_=t[12],p=t[13],v=t[14],y=t[15],m=r*s-n*o,w=r*u-i*o,E=r*l-a*o,g=n*u-i*s,b=n*l-a*s,M=i*l-a*u,R=h*p-c*_,A=h*v-f*_,T=h*y-d*_,O=c*v-f*p,P=c*y-d*p,x=f*y-d*v,I=m*x-w*P+E*O+g*T-b*A+M*R;return I?(I=1/I,e[0]=(s*x-u*P+l*O)*I,e[1]=(i*P-n*x-a*O)*I,e[2]=(p*M-v*b+y*g)*I,e[3]=(f*b-c*M-d*g)*I,e[4]=(u*T-o*x-l*A)*I,e[5]=(r*x-i*T+a*A)*I,e[6]=(v*E-_*M-y*w)*I,e[7]=(h*M-f*E+d*w)*I,e[8]=(o*P-s*T+l*R)*I,e[9]=(n*T-r*P-a*R)*I,e[10]=(_*b-p*E+y*m)*I,e[11]=(c*E-h*b-d*m)*I,e[12]=(s*A-o*O-u*R)*I,e[13]=(r*O-n*A+i*R)*I,e[14]=(p*w-_*g-v*m)*I,e[15]=(h*g-c*w+f*m)*I,e):null}},{key:"mat4_multiply",value:function(e,t,r){var n=t[0],i=t[4],a=t[8],o=t[12],s=t[1],u=t[5],l=t[9],h=t[13],c=t[2],f=t[6],d=t[10],_=t[14],p=t[3],v=t[7],y=t[11],m=t[15],w=r[0],E=r[4],g=r[8],b=r[12],M=r[1],R=r[5],A=r[9],T=r[13],O=r[2],P=r[6],x=r[10],I=r[14],N=r[3],k=r[7],S=r[11],C=r[15];return e[0]=n*w+i*M+a*O+o*N,e[4]=n*E+i*R+a*P+o*k,e[8]=n*g+i*A+a*x+o*S,e[12]=n*b+i*T+a*I+o*C,e[1]=s*w+u*M+l*O+h*N,e[5]=s*E+u*R+l*P+h*k,e[9]=s*g+u*A+l*x+h*S,e[13]=s*b+u*T+l*I+h*C,e[2]=c*w+f*M+d*O+_*N,e[6]=c*E+f*R+d*P+_*k,e[10]=c*g+f*A+d*x+_*S,e[14]=c*b+f*T+d*I+_*C,e[3]=p*w+v*M+y*O+m*N,e[7]=p*E+v*R+y*P+m*k,e[11]=p*g+v*A+y*x+m*S,e[15]=p*b+v*T+y*I+m*C,e}}]),e}();t.default=s,s.PI_OVER_180=Math.PI/180},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uid=r||e._generateUID(),this._coordinateSystem=t}return n(e,[{key:"uid",get:function(){return this._uid}},{key:"coordinateSystem",get:function(){return this._coordinateSystem}}],[{key:"_generateUID",value:function(){return"anchor-"+(new Date).getTime()+"-"+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=r,this.z=n,this.w=i}return n(e,[{key:"set",value:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}},{key:"toArray",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}},{key:"setFromRotationMatrix",value:function(e){var t=e[0],r=e[4],n=e[8],i=e[1],a=e[5],o=e[9],s=e[2],u=e[6],l=e[10],h=t+a+l;if(h>0){var c=.5/Math.sqrt(h+1);this.w=.25/c,this.x=(u-o)*c,this.y=(n-s)*c,this.z=(i-r)*c}else if(t>a&&t>l){c=2*Math.sqrt(1+t-a-l);this.w=(u-o)/c,this.x=.25*c,this.y=(r+i)/c,this.z=(n+s)/c}else if(a>l){c=2*Math.sqrt(1+a-t-l);this.w=(n-s)/c,this.x=(r+i)/c,this.y=.25*c,this.z=(o+u)/c}else{c=2*Math.sqrt(1+l-t-a);this.w=(i-r)/c,this.x=(n+s)/c,this.y=(o+u)/c,this.z=.25*c}return this}},{key:"setFromEuler",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"XYZ",i=Math.cos,a=Math.sin,o=i(e/2),s=i(t/2),u=i(r/2),l=a(e/2),h=a(t/2),c=a(r/2);"XYZ"===n?(this.x=l*s*u+o*h*c,this.y=o*h*u-l*s*c,this.z=o*s*c+l*h*u,this.w=o*s*u-l*h*c):"YXZ"===n?(this.x=l*s*u+o*h*c,this.y=o*h*u-l*s*c,this.z=o*s*c-l*h*u,this.w=o*s*u+l*h*c):"ZXY"===n?(this.x=l*s*u-o*h*c,this.y=o*h*u+l*s*c,this.z=o*s*c+l*h*u,this.w=o*s*u-l*h*c):"ZYX"===n?(this.x=l*s*u-o*h*c,this.y=o*h*u+l*s*c,this.z=o*s*c-l*h*u,this.w=o*s*u+l*h*c):"YZX"===n?(this.x=l*s*u+o*h*c,this.y=o*h*u+l*s*c,this.z=o*s*c-l*h*u,this.w=o*s*u-l*h*c):"XZY"===n&&(this.x=l*s*u-o*h*c,this.y=o*h*u-l*s*c,this.z=o*s*c+l*h*u,this.w=o*s*u+l*h*c)}},{key:"setFromAxisAngle",value:function(e,t){var r=t/2,n=Math.sin(r);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(r),this}},{key:"multiply",value:function(e){return this.multiplyQuaternions(this,e)}},{key:"multiplyQuaternions",value:function(e,t){var r=e.x,n=e.y,i=e.z,a=e.w,o=t.x,s=t.y,u=t.z,l=t.w;return this.x=r*l+a*o+n*u-i*s,this.y=n*l+a*s+i*o-r*u,this.z=i*l+a*u+r*s-n*o,this.w=a*l-r*o-n*s-i*u,this}},{key:"inverse",value:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this}},{key:"normalize",value:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this.x,n=this.y,i=this.z,a=this.w,o=a*e.w+r*e.x+n*e.y+i*e.z;if(o<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,o=-o):this.copy(e),o>=1)return this.w=a,this.x=r,this.y=n,this.z=i,this;var s=Math.acos(o),u=Math.sqrt(1-o*o);if(Math.abs(u)<.001)return this.w=.5*(a+this.w),this.x=.5*(r+this.x),this.y=.5*(n+this.y),this.z=.5*(i+this.z),this;var l=Math.sin((1-t)*s)/u,h=Math.sin(t*s)/u;return this.w=a*l+this.w*h,this.x=r*l+this.x*h,this.y=n*l+this.y*h,this.z=i*l+this.z*h,this}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners=new Map}return n(e,[{key:"addEventListener",value:function(e,t){var r=this._listeners.get(e);!1===Array.isArray(r)&&(r=[],this._listeners.set(e,r)),r.push(t)}},{key:"removeEventListener",value:function(e,t){var r=this._listeners.get(e);if(!1!==Array.isArray(r))for(var n=0;n<r.length;n++)if(r[n]===t)return void r.splice(n,1)}},{key:"dispatchEvent",value:function(e){var t=this._listeners.get(e.type);if(!1!==Array.isArray(t)){var r=t.slice(0),n=!0,i=!1,a=void 0;try{for(var o,s=r[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){(0,o.value)(e)}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}}}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))};var n=t.EPSILON=1e-6;t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random;var i=Math.PI/180},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=f(r(3)),o=(c(r(4)),c(r(17))),s=c(r(18)),u=c(r(12)),l=f(r(19)),h=(f(r(2)),f(r(0)));function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!1===t.HasARKit())throw"ARKitWrapper will only work in Mozilla's ARDemo test app";if(void 0!==t.GLOBAL_INSTANCE)throw"ARKitWrapper is a singleton. Use ARKitWrapper.GetOrCreate() to get the global instance.";e._deviceId=null,e._isWatching=!1,e._isInitialized=!1,e._rawARData=null,e.lightIntensity=1e3,e.projectionMatrix_=new Float32Array(16),e.viewMatrix_=new Float32Array(16),e.planes_=new Map,e.anchors_=new Map,e._timeOffsets=[],e._timeOffset=0,e._timeOffsetComputed=!1,e.timestamp=0,e.worldMappingStatus=t.WEB_AR_WORLDMAPPING_NOT_AVAILABLE,e._globalCallbacksMap={};for(var r=["onInit","onWatch"],n=0;n<r.length;n++)e._generateGlobalCallback(r[n],n);e._defaultOptions={location:!0,camera:!0,objects:!0,light_intensity:!0,computer_vision_data:!1},e._m90=o.fromZRotation(o.create(),90*h.default.PI_OVER_180),e._m90neg=o.fromZRotation(o.create(),-90*h.default.PI_OVER_180),e._m180=o.fromZRotation(o.create(),180*h.default.PI_OVER_180),e._mTemp=o.create();for(var i=[["arkitStartRecording",t.RECORD_START_EVENT],["arkitStopRecording",t.RECORD_STOP_EVENT],["arkitDidMoveBackground",t.DID_MOVE_BACKGROUND_EVENT],["arkitWillEnterForeground",t.WILL_ENTER_FOREGROUND_EVENT],["arkitInterrupted",t.INTERRUPTED_EVENT],["arkitInterruptionEnded",t.INTERRUPTION_ENDED_EVENT],["arkitShowDebug",t.SHOW_DEBUG_EVENT],["arkitWindowResize",t.WINDOW_RESIZE_EVENT],["onError",t.ON_ERROR],["arTrackingChanged",t.AR_TRACKING_CHANGED],["userGrantedComputerVisionData",t.USER_GRANTED_COMPUTER_VISION_DATA],["userGrantedWorldSensingData",t.USER_GRANTED_WORLD_SENSING_DATA]],a=function(t){window[i[t][0]]=function(r){r=r||null;try{e.dispatchEvent(new CustomEvent(i[t][1],{source:e,detail:r}))}catch(e){console.error(i[t][0]+" callback error",e)}}},l=0;l<i.length;l++)a(l);function c(){return this.modelMatrix=new Float32Array(16),this}window.onComputerVisionData=function(t){e._onComputerVisionData(t)},window.setNativeTime=function(t){e._timeOffsets.push((performance||Date).now()-t.nativeTime),e._timeOffsetComputed=!0,e._timeOffset=0;for(var r=0;r<e._timeOffsets.length;r++)e._timeOffset+=e._timeOffsets[r];e._timeOffset=e._timeOffset/e._timeOffsets.length,console.log("Native time: "+t.nativeTime+", new timeOffset: "+e._timeOffset)},e._adjustARKitTime=function(e){return this._timeOffsetComputed?e+this._timeOffset:(performance||Date).now()};var f,d,_,p,v,y=e;return e.getPlanes=function(){return Array.from(this.planes_.values())},e.hitTestNoAnchor=(d={rayStart:u.create(),rayEnd:u.create(),cameraPosition:u.create(),cameraQuaternion:s.create(),modelViewMatrix:o.create(),projectionMatrix:o.create(),projViewMatrix:o.create(),worldRayStart:u.create(),worldRayEnd:u.create(),worldRayDir:u.create(),planeMatrix:o.create(),planeExtent:u.create(),planePosition:u.create(),planeCenter:u.create(),planeNormal:u.create(),planeIntersection:u.create(),planeIntersectionLocal:u.create(),planeHit:o.create(),planeQuaternion:s.create()},_=function(e,t){o.set(e,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},f=u.create(),p=function(e,t,r,n){var i=u.dot(e,n);return u.subtract(f,t,r),u.dot(f,e)/i},v=function(e,t){_(d.planeMatrix,e.modelMatrix),o.getTranslation(d.planeIntersection,d.planeMatrix);var r=u.distance(d.planeIntersection,d.cameraPosition);return _(d.planeMatrix,t.modelMatrix),o.getTranslation(d.planeIntersection,d.planeMatrix),r<u.distance(d.planeIntersection,d.cameraPosition)?-1:1},function(e,t){if(e<0||e>1||t<0||t>1)throw new Error("hitTest - x and y values must be normalized [0,1]!");var r=[],n=this.getPlanes();if(!n||0==n.length)return r;u.set(d.rayStart,2*e-1,2*(1-t)-1,0),u.set(d.rayEnd,2*e-1,2*(1-t)-1,1),_(d.projectionMatrix,y.projectionMatrix_),_(d.modelViewMatrix,y.viewMatrix_),o.multiply(d.projViewMatrix,d.projectionMatrix,d.modelViewMatrix),o.invert(d.projViewMatrix,d.projViewMatrix),u.transformMat4(d.worldRayStart,d.rayStart,d.projViewMatrix),u.transformMat4(d.worldRayEnd,d.rayEnd,d.projViewMatrix),u.subtract(d.worldRayDir,d.worldRayEnd,d.worldRayStart),u.normalize(d.worldRayDir,d.worldRayDir);for(var i=0;i<n.length;i++){var a=n[i];_(d.planeMatrix,a.modelMatrix),u.set(d.planeCenter,a.center.x,a.center.y,a.center.z),u.transformMat4(d.planePosition,d.planeCenter,d.planeMatrix),d.planeAlignment=a.alignment,0===d.planeAlignment?u.set(d.planeNormal,0,1,0):u.set(d.planeNormal,d.planeMatrix[4],d.planeMatrix[5],d.planeMatrix[6]);var s=p(d.planeNormal,d.planePosition,d.worldRayStart,d.worldRayDir);if(!(s<0||(u.scale(d.planeIntersection,d.worldRayDir,s),u.add(d.planeIntersection,d.worldRayStart,d.planeIntersection),u.set(d.planeExtent,a.extent[0],0,a.extent[1]),o.getRotation(d.planeQuaternion,d.planeMatrix),o.invert(d.planeMatrix,d.planeMatrix),u.transformMat4(d.planeIntersectionLocal,d.planeIntersection,d.planeMatrix),Math.abs(d.planeIntersectionLocal[0])>d.planeExtent[0]/2+.0075||Math.abs(d.planeIntersectionLocal[2])>d.planeExtent[2]/2+.0075))){o.fromRotationTranslation(d.planeHit,d.planeQuaternion,d.planeIntersection);for(var l=new c,h=0;h<16;h++)l.modelMatrix[h]=d.planeHit[h];l.i=i,r.push(l)}}return r.sort(v),r}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"waitForInit",value:function(){var e=this;return new Promise((function(r,n){if(e._isInitialized)r();else{e.addEventListener(t.INIT_EVENT,(function n(){e.removeEventListener(t.INIT_EVENT,n,!1),r()}),!1)}}))}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this._rawARData:this._rawARData&&void 0!==this._rawARData[e]?this._rawARData[e]:null}},{key:"getObject",value:function(e){if(!this._isInitialized)return null;var t=this.getKey("objects");if(null===t)return null;var r=!0,n=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;if(s.uuid===e)return s}}catch(e){n=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}return null}},{key:"hitTest",value:function(e,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.HIT_TEST_TYPE_ALL;return new Promise((function(t,a){n._isInitialized?window.webkit.messageHandlers.hitTest.postMessage({x:e,y:r,type:i,callback:n._createPromiseCallback("hitTest",t)}):a(new Error("ARKit is not initialized"))}))}},{key:"addAnchor",value:function(e,t){var r=this;return new Promise((function(n,i){r._isInitialized?window.webkit.messageHandlers.addAnchor.postMessage({uuid:e,transform:t,callback:r._createPromiseCallback("addAnchor",n)}):i(new Error("ARKit is not initialized"))}))}},{key:"removeAnchor",value:function(e){window.webkit.messageHandlers.removeAnchors.postMessage([e])}},{key:"createImageAnchor",value:function(e,t,r,n,i){var a=this;return new Promise((function(o,s){if(a._isInitialized){var u=l.default.encode(t);window.webkit.messageHandlers.createImageAnchor.postMessage({uid:e,buffer:u,imageWidth:r,imageHeight:n,physicalWidth:i,callback:a._createPromiseCallback("createImageAnchor",o)})}else s(new Error("ARKit is not initialized"))}))}},{key:"activateDetectionImage",value:function(e){var t=this;return new Promise((function(r,n){t._isInitialized?window.webkit.messageHandlers.activateDetectionImage.postMessage({uid:e,callback:t._createPromiseCallback("activateDetectionImage",r)}):n(new Error("ARKit is not initialized"))}))}},{key:"getWorldMap",value:function(){var e=this;return new Promise((function(t,r){e._isInitialized?window.webkit.messageHandlers.getWorldMap.postMessage({callback:e._createPromiseCallback("getWorldMap",t)}):r(new Error("ARKit is not initialized"))}))}},{key:"setWorldMap",value:function(e){var t=this;return new Promise((function(r,n){t._isInitialized?window.webkit.messageHandlers.setWorldMap.postMessage({worldMap:e.worldMap,callback:t._createPromiseCallback("setWorldMap",r)}):n(new Error("ARKit is not initialized"))}))}},{key:"stop",value:function(){var e=this;return new Promise((function(t,r){e._isWatching?(console.log("----STOP"),window.webkit.messageHandlers.stopAR.postMessage({callback:e._createPromiseCallback("stop",t)})):t()}))}},{key:"watch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this._isInitialized)return!1;if(this._isWatching)return!0;this._isWatching=!0;var t=Object.assign({},this._defaultOptions);null!=e&&(t=Object.assign(t,e)),t.videoFrames&&(delete t.videoFrames,t.computer_vision_data=!0);var r={options:t,callback:this._globalCallbacksMap.onWatch};return console.log("----WATCH"),window.webkit.messageHandlers.watchAR.postMessage(r),!0}},{key:"setUIOptions",value:function(e){window.webkit.messageHandlers.setUIOptions.postMessage(e)}},{key:"_sendInit",value:function(e){console.log("----INIT"),window.webkit.messageHandlers.initAR.postMessage({options:e,callback:this._globalCallbacksMap.onInit})}},{key:"_onInit",value:function(e){this._deviceId=e,this._isInitialized=!0;try{this.dispatchEvent(new CustomEvent(t.INIT_EVENT,{source:this}))}catch(e){console.error("INIT_EVENT event error",e)}}},{key:"_onWatch",value:function(e){this._rawARData=e;try{this.dispatchEvent(new CustomEvent(t.WATCH_EVENT,{source:this,detail:this._rawARData}))}catch(e){console.error("WATCH_EVENT event error",e)}if(this.timestamp=this._adjustARKitTime(e.timestamp),this.lightIntensity=e.light_intensity,this.viewMatrix_=e.camera_view,this.projectionMatrix_=e.projection_camera,this.worldMappingStatus=e.worldMappingStatus,e.newObjects.length)for(var r=0;r<e.newObjects.length;r++){var n=e.newObjects[r];n.plane_center?this.planes_.set(n.uuid,{id:n.uuid,center:n.plane_center,extent:[n.plane_extent.x,n.plane_extent.z],modelMatrix:n.transform,alignment:n.plane_alignment}):this.anchors_.set(n.uuid,{id:n.uuid,modelMatrix:n.transform})}if(e.removedObjects.length)for(var i=0;i<e.removedObjects.length;i++){var a=e.removedObjects[i];this.planes_.get(a)?this.planes_.delete(a):this.anchors_.delete(a)}if(e.objects.length)for(var o=0;o<e.objects.length;o++){var s=e.objects[o];if(s.plane_center){var u=this.planes_.get(s.uuid);u?(u.center=s.plane_center,u.extent[0]=s.plane_extent.x,u.extent[1]=s.plane_extent.z,u.modelMatrix=s.transform,u.alignment=s.plane_alignment):this.planes_.set(s.uuid,{id:s.uuid,center:s.plane_center,extent:[s.plane_extent.x,s.plane_extent.z],modelMatrix:s.transform,alignment:s.plane_alignment})}else{var l=this.anchors_.get(s.uuid);l?l.modelMatrix=s.transform:this.anchors_.set(s.uuid,{id:s.uuid,modelMatrix:s.transform})}}}},{key:"_onStop",value:function(){this._isWatching=!1}},{key:"_createPromiseCallback",value:function(e,t){var r=this,n=this._generateCallbackUID(e);return window[n]=function(i){delete window[n];var a="_on"+e[0].toUpperCase()+e.slice(1);"function"==typeof r[a]&&r[a](i),t(i)},n}},{key:"_generateCallbackUID",value:function(e){return"arkitCallback_"+e+"_"+(new Date).getTime()+"_"+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}},{key:"_generateGlobalCallback",value:function(e,t){var r="arkitCallback"+t;this._globalCallbacksMap[e]=r;var n=this;window[r]=function(t){n["_"+e](t)}}},{key:"_onComputerVisionData",value:function(e){if(!e)return console.error("detail passed to _onComputerVisionData is null"),void this._requestComputerVisionData();if(!e.frame||!e.frame.buffers||e.frame.buffers.length<=0)return console.error("detail passed to _onComputerVisionData is bad, no buffers"),void this._requestComputerVisionData();e.camera.arCamera=!0;var r=e.camera.interfaceOrientation;switch(e.camera.viewMatrix=e.camera.inverse_viewMatrix,r){case 1:e.camera.cameraOrientation=-90;break;case 2:e.camera.cameraOrientation=90;break;case 3:e.camera.cameraOrientation=0;break;case 4:e.camera.cameraOrientation=180}switch(e.frame.pixelFormatType){case"kCVPixelFormatType_420YpCbCr8BiPlanarFullRange":e.frame.pixelFormat="YUV420P";break;default:e.frame.pixelFormat=e.frame.pixelFormatType}var n=new XRVideoFrame(e.frame.buffers,e.frame.pixelFormat,this._adjustARKitTime(e.frame.timestamp),e.camera);try{this.dispatchEvent(new CustomEvent(t.COMPUTER_VISION_DATA,{source:this,detail:n}))}catch(e){console.error("COMPUTER_VISION_DATA event error",e)}}},{key:"_requestComputerVisionData",value:function(){window.webkit.messageHandlers.requestComputerVisionData.postMessage({})}},{key:"_startSendingComputerVisionData",value:function(){window.webkit.messageHandlers.startSendingComputerVisionData.postMessage({})}},{key:"_stopSendingComputerVisionData",value:function(){window.webkit.messageHandlers.stopSendingComputerVisionData.postMessage({})}},{key:"deviceId",get:function(){return this._deviceId}},{key:"isWatching",get:function(){return this._isWatching}},{key:"isInitialized",get:function(){return this._isInitialized}},{key:"hasData",get:function(){return null!==this._rawARData}}],[{key:"GetOrCreate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(void 0===t.GLOBAL_INSTANCE){t.GLOBAL_INSTANCE=new t,e=e&&"object"==(void 0===e?"undefined":n(e))?e:{};var r={browser:!0,points:!0,focus:!1,rec:!0,rec_time:!0,mic:!1,build:!1,plane:!0,warnings:!0,anchors:!1,debug:!0,statistics:!1},i="object"==n(e.ui)?e.ui:{};e.ui=Object.assign(r,i),t.GLOBAL_INSTANCE._sendInit(e)}return t.GLOBAL_INSTANCE}},{key:"HasARKit",value:function(){return void 0!==window.webkit}}]),t}(a.default);t.default=d,d.INIT_EVENT="arkit-init",d.WATCH_EVENT="arkit-watch",d.RECORD_START_EVENT="arkit-record-start",d.RECORD_STOP_EVENT="arkit-record-stop",d.DID_MOVE_BACKGROUND_EVENT="arkit-did-move-background",d.WILL_ENTER_FOREGROUND_EVENT="arkit-will-enter-foreground",d.INTERRUPTED_EVENT="arkit-interrupted",d.INTERRUPTION_ENDED_EVENT="arkit-interruption-ended",d.SHOW_DEBUG_EVENT="arkit-show-debug",d.WINDOW_RESIZE_EVENT="arkit-window-resize",d.ON_ERROR="on-error",d.AR_TRACKING_CHANGED="ar_tracking_changed",d.COMPUTER_VISION_DATA="cv_data",d.USER_GRANTED_COMPUTER_VISION_DATA="user-granted-cv-data",d.USER_GRANTED_WORLD_SENSING_DATA="user-granted-world-sensing-data",d.ORIENTATION_UP=1,d.ORIENTATION_UP_MIRRORED=2,d.ORIENTATION_DOWN=3,d.ORIENTATION_DOWN_MIRRORED=4,d.ORIENTATION_LEFT_MIRRORED=5,d.ORIENTATION_RIGHT=6,d.ORIENTATION_RIGHT_MIRRORED=7,d.ORIENTATION_LEFT=8,d.WEB_AR_WORLDMAPPING_NOT_AVAILABLE="ar_worldmapping_not_available",d.WEB_AR_WORLDMAPPING_LIMITED="ar_worldmapping_limited",d.WEB_AR_WORLDMAPPING_EXTENDING="ar_worldmapping_extending",d.WEB_AR_WORLDMAPPING_MAPPED="ar_worldmapping_mapped",d.HIT_TEST_TYPE_FEATURE_POINT=1,d.HIT_TEST_TYPE_ESTIMATED_HORIZONTAL_PLANE=2,d.HIT_TEST_TYPE_ESTIMATED_VERTICAL_PLANE=4,d.HIT_TEST_TYPE_EXISTING_PLANE=8,d.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT=16,d.HIT_TEST_TYPE_EXISTING_PLANE_USING_GEOMETRY=32,d.HIT_TEST_TYPE_ALL=d.HIT_TEST_TYPE_FEATURE_POINT|d.HIT_TEST_TYPE_EXISTING_PLANE|d.HIT_TEST_TYPE_ESTIMATED_HORIZONTAL_PLANE|d.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT,d.HIT_TEST_TYPE_EXISTING_PLANES=d.HIT_TEST_TYPE_EXISTING_PLANE|d.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT,d.ANCHOR_TYPE_PLANE="plane",d.ANCHOR_TYPE_FACE="face",d.ANCHOR_TYPE_ANCHOR="anchor",d.ANCHOR_TYPE_IMAGE="image"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(r(0)),a=u(r(3)),o=u(r(26)),s=u(r(16));u(r(7));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,r,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));o._xr=e,o._displayName=r,o._isExternal=n,o._reality=a,o._headModelCoordinateSystem=new XRCoordinateSystem(o,XRCoordinateSystem.HEAD_MODEL),o._eyeLevelCoordinateSystem=new XRCoordinateSystem(o,XRCoordinateSystem.EYE_LEVEL),o._trackerCoordinateSystem=new XRCoordinateSystem(o,XRCoordinateSystem.TRACKER),o._headPose=new XRViewPose([0,XRViewPose.SITTING_EYE_HEIGHT,0]),o._eyeLevelPose=new XRViewPose([0,XRViewPose.SITTING_EYE_HEIGHT,0]),o._trackerPoseModelMatrix=i.default.mat4_generateIdentity(),o._fovy=70;var u=o._fovy/2;return o._fov=new s.default(u,u,u,u),o._depthNear=.1,o._depthFar=1e3,o._views=[],o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"supportsSession",value:function(e){return this._supportedCreationParameters(e)}},{key:"requestSession",value:function(e){var t=this;return new Promise((function(r,n){!1!==t._supportedCreationParameters(e)?(e.type===XRSession.REALITY&&(t._reality=new o.default,t._xr._privateRealities.push(t._reality)),r(t._createSession(e))):n()}))}},{key:"_requestVideoFrame",value:function(){}},{key:"_requestAnimationFrame",value:function(e){return window.requestAnimationFrame(e)}},{key:"_cancelAnimationFrame",value:function(e){return window.cancelAnimationFrame(e)}},{key:"_createSession",value:function(e){return new XRSession(this._xr,this,e)}},{key:"_supportedCreationParameters",value:function(e){throw"Should be implemented by extending class"}},{key:"_handleNewFrame",value:function(e){}},{key:"_handleAfterFrame",value:function(e){}},{key:"_handleNewBaseLayer",value:function(e){}},{key:"displayName",get:function(){return this._displayName}},{key:"isExternal",get:function(){return this._isExternal}}]),t}(a.default);t.default=l,l.VIDEO_FRAME="videoFrame",l.TRACKING_CHANGED="tracking-changed",l.NEW_WORLD_ANCHOR="world-anchor",l.UPDATE_WORLD_ANCHOR="update-world-anchor",l.REMOVE_WORLD_ANCHOR="remove-world-anchor"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(3);var o=function(e){function t(e,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._xr=e,a._name=r,a._isShared=n,a._isPassthrough=i,a._anchors=new Map,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"getCoordinateSystem",value:function(){throw new Error("Not implemented")}},{key:"_start",value:function(e){throw new Error("Extending classes should implement _start")}},{key:"_stop",value:function(){throw new Error("Extending classes should implement _stop")}},{key:"_requestVideoFrame",value:function(){}},{key:"_stopVideoFrames",value:function(){}},{key:"_startVideoFrames",value:function(){}},{key:"_handleNewFrame",value:function(){}},{key:"_addAnchor",value:function(e,t){throw new Error("Extending classes should implement _addAnchor")}},{key:"_findAnchor",value:function(e,t,r){throw new Error("Extending classes should implement _findAnchor")}},{key:"_createImageAnchor",value:function(e,t,r,n,i){throw new Error("Extending classes should implement _createImageAnchor")}},{key:"activateDetectionImage",value:function(e,t){throw new Error("Extending classes should implement _activateDetectionImage")}},{key:"_findFloorAnchor",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];throw new Error("Extending classes should implement _findFloorAnchor")}},{key:"_getAnchor",value:function(e){return this._anchors.get(e)||null}},{key:"_removeAnchor",value:function(e){throw new Error("Extending classes should implement _removeAnchor")}},{key:"_hitTestNoAnchor",value:function(e,t,r){throw new Error("Extending classes should implement _hitTestNoAnchor")}},{key:"_getLightAmbientIntensity",value:function(){throw new Error("Extending classes should implement _getLightAmbientIntensity")}},{key:"_getWorldMap",value:function(){throw new Error("Extending classes should implement _getWorldMap")}},{key:"_setWorldMap",value:function(e){throw new Error("Extending classes should implement _setWorldMap")}},{key:"_getWorldMappingStatus",value:function(){throw new Error("Extending classes should implement _getWorldMappingStatus")}},{key:"name",get:function(){return this._name}},{key:"isShared",get:function(){return this._isShared}},{key:"isPassthrough",get:function(){return this._isPassthrough}}]),t}(((n=a)&&n.__esModule?n:{default:n}).default);t.default=o,o.COMPUTER_VISION_DATA="cv_data",o.WINDOW_RESIZE_EVENT="window-resize",o.NEW_WORLD_ANCHOR="world-anchor",o.UPDATE_WORLD_ANCHOR="update-world-anchor",o.REMOVE_WORLD_ANCHOR="remove-world-anchor"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1);var o=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],i=arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return a.geometry=n,a.blendShapes={},a.updateBlendShapes(i),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"updateBlendShapes",value:function(e){for(var t=0;t<s.length;t++)this.blendShapes[s[t]]=e[t]}}]),t}(((n=a)&&n.__esModule?n:{default:n}).default);t.default=o;var s=["browDownLeft","browDownRight","browInnerUp","browOuterUpLeft","browOuterUpRight","cheekPuff","cheekSquintLeft","cheekSquintRight","eyeBlinkLeft","eyeBlinkRight","eyeLookDownLeft","eyeLookDownRight","eyeLookInLeft","eyeLookInRight","eyeLookOutLeft","eyeLookOutRight","eyeLookUpLeft","eyeLookUpRight","eyeSquintLeft","eyeSquintRight","eyeWideLeft","eyeWideRight","jawForward","jawLeft","jawOpen","jawRight","mouthClose","mouthDimpleLeft","mouthDimpleRight","mouthFrownLeft","mouthFrownRight","mouthFunnel","mouthLeft","mouthLowerDownLeft","mouthLowerDownRight","mouthPressLeft","mouthPressRight","mouthPucker","mouthRight","mouthRollLower","mouthRollUpper","mouthShrugLower","mouthShrugUpper","mouthSmileLeft","mouthSmileRight","mouthStretchLeft","mouthStretchRight","mouthUpperUpLeft","mouthUpperUpRight","noseSneerLeft","noseSneerRight"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(1);var a=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((n=i)&&n.__esModule?n:{default:n}).default);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1);var o=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],i=arguments[3],a=arguments[4],o=arguments[5];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return s.center=n,s.extent=i,s.alignment=a,s.geometry=o,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"width",get:function(){throw"Not implemented"}},{key:"length",get:function(){throw"Not implemented"}}]),t}(((n=a)&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(3)),a=s(r(0)),o=s(r(6));s(r(8)),s(r(9)),s(r(1)),s(r(5)),s(r(10));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._xr=e,i._display=r,i._createParameters=n,i._ended=!1,i._baseLayer=null,i._stageBounds=null,i._skip=!1,i._frameAnchors=[],i._tempMatrix=a.default.mat4_generateIdentity(),i._tempMatrix2=a.default.mat4_generateIdentity(),i._display.addEventListener(o.default.TRACKING_CHANGED,i._handleTrackingChanged.bind(i)),i._display.addEventListener(o.default.NEW_WORLD_ANCHOR,i._handleNewWorldAnchor.bind(i)),i._display.addEventListener(o.default.REMOVE_WORLD_ANCHOR,i._handleRemoveWorldAnchor.bind(i)),i._display.addEventListener(o.default.UPDATE_WORLD_ANCHOR,i._handleUpdateWorldAnchor.bind(i)),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"requestFrame",value:function(e){if(this._ended)return null;if("function"!=typeof e)throw"Invalid callback";return this._handleRequestFrame(e)}},{key:"_handleRequestFrame",value:function(e){var t=this;return this._display._requestAnimationFrame((function(r){if(t._skip)return t._skip=!1,t._handleRequestFrame(e);var n=t._createPresentationFrame(r);t._updateCameraAnchor(n),t._display._reality._handleNewFrame(n),t._display._handleNewFrame(n),e(n),t._display._handleAfterFrame(n)}))}},{key:"cancelFrame",value:function(e){return this._display._cancelAnimationFrame(e)}},{key:"end",value:function(){if(!this._ended){for(var e=0;e<this._frameAnchors.length;e++)this._display._reality._removeAnchor(this._frameAnchors[e].uid);return this._frameAnchors=[],this._ended=!0,this._display._stop(),new Promise((function(e,t){e()}))}}},{key:"_updateCameraAnchor",value:function(e){if(0==this._frameAnchors.length||this._frameAnchors[0].timestamp+1e3<e.timestamp){var t=e.getCoordinateSystem(XRCoordinateSystem.EYE_LEVEL),r=e.addAnchor(t,[0,-1,0],[0,0,0,1],"cameraAnchor-"+(new Date).getTime()+"-"+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)),n=e.getAnchor(r);if(n.timestamp=e.timestamp,this._frameAnchors.unshift(n),this._frameAnchors.length>5){var i=this._frameAnchors.pop();this._display._reality._removeAnchor(i.uid)}return n}return this._frameAnchors[0]}},{key:"_transformToCameraAnchor",value:function(e){if(0==this._frameAnchors.length)return e.viewMatrix;var t=e.viewMatrix;e._anchorUid=this._frameAnchors[0].uid;var r=this._frameAnchors[0].coordinateSystem;a.default.mat4_invert(this._tempMatrix,r._poseModelMatrix),a.default.mat4_multiply(e.viewMatrix,this._tempMatrix,t)}},{key:"setVideoFrameHandler",value:function(e){var t=this;if(e instanceof Worker){var r=e;e=function(e){t._transformToCameraAnchor(e.detail.camera),e.detail.postMessageToWorker(r,{type:"newVideoFrame"}),e.detail.release()}}else{var n=e;e=function(e){t._transformToCameraAnchor(e.detail.camera),n(e)}}this._display.addEventListener("videoFrame",e)}},{key:"getVideoFramePose",value:function(e,t){if(e.camera._anchorUid){var r,n=this.reality._getAnchor(e.camera._anchorUid);if(n)r=n.coordinateSystem._poseModelMatrix;else{for(var i=0;i<this._frameAnchors.length;i++)if(e.camera._anchorUid==this._frameAnchors[i].uid){r=this._frameAnchors[i].coordinateSystem._poseModelMatrix;break}if(i==this._frameAnchors.length)return void console.warn("should never get here: session.getVideoFramePose can't find anchor")}a.default.mat4_multiply(t,r,e.camera.viewMatrix)}}},{key:"hitTest",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.reality._findAnchor(e,t,this.display,r)}},{key:"requestVideoFrame",value:function(){this._display._requestVideoFrame()}},{key:"stopVideoFrames",value:function(){this._display._stopVideoFrames()}},{key:"startVideoFrames",value:function(){this._display._startVideoFrames()}},{key:"_createPresentationFrame",value:function(e){return new XRPresentationFrame(this,e)}},{key:"_getCoordinateSystem",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;switch(u){case XRCoordinateSystem.HEAD_MODEL:return this._display._headModelCoordinateSystem;case XRCoordinateSystem.EYE_LEVEL:return this._display._eyeLevelCoordinateSystem;case XRCoordinateSystem.TRACKER:return this._display._trackerCoordinateSystem;case XRCoordinateSystem.GEOSPATIAL:default:continue}}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return null}},{key:"createImageAnchor",value:function(e,t,r,n,i){return this.reality._createImageAnchor(e,t,r,n,i)}},{key:"activateDetectionImage",value:function(e){return this.reality._activateDetectionImage(e,this._display)}},{key:"_handleNewWorldAnchor",value:function(e){var r=e.detail;if(!r.uid.startsWith("cameraAnchor-"))try{this.dispatchEvent(new CustomEvent(t.NEW_WORLD_ANCHOR,{source:this,detail:r}))}catch(e){console.error("NEW_WORLD_ANCHOR event error",e)}}},{key:"_handleUpdateWorldAnchor",value:function(e){var r=e.detail;try{this.dispatchEvent(new CustomEvent(t.UPDATE_WORLD_ANCHOR,{source:this,detail:r}))}catch(e){console.error("UPDATE_WORLD_ANCHOR event error",e)}}},{key:"_handleRemoveWorldAnchor",value:function(e){var r=e.detail;try{this.dispatchEvent(new CustomEvent(t.REMOVE_WORLD_ANCHOR,{source:this,detail:r}))}catch(e){console.error("REMOVE_WORLD_ANCHOR event error",e)}}},{key:"_handleTrackingChanged",value:function(e){try{this.dispatchEvent(new CustomEvent(t.TRACKING_CHANGED,{source:this,detail:e.detail}))}catch(e){console.error("TRACKING_CHANGED event error",e)}}},{key:"getWorldMap",value:function(){return this.reality._getWorldMap()}},{key:"setWorldMap",value:function(e){return this.reality._setWorldMap(e)}},{key:"getWorldMappingStatus",value:function(){return this.reality._getWorldMappingStatus()}},{key:"display",get:function(){return this._display}},{key:"createParameters",get:function(){return this._parameters}},{key:"realities",get:function(){return this._xr._sharedRealities}},{key:"reality",get:function(){return this._display._reality}},{key:"baseLayer",get:function(){return this._baseLayer},set:function(e){this._baseLayer=e,this._display._handleNewBaseLayer(this._baseLayer)}},{key:"depthNear",get:function(){this._display._depthNear},set:function(e){this._display._depthNear=e}},{key:"depthFar",get:function(){this._display._depthFar},set:function(e){this._display._depthFar=e}},{key:"hasStageBounds",get:function(){this._stageBounds}},{key:"stageBounds",get:function(){return this._stageBounds}}]),t}(i.default);t.default=u,u.REALITY="reality",u.AUGMENTATION="augmentation",u.TYPES=[u.REALITY,u.AUGMENTATION],u.TRACKING_CHANGED="tracking-changed",u.NEW_WORLD_ANCHOR="world-anchor",u.UPDATE_WORLD_ANCHOR="update-world-anchor",u.REMOVE_WORLD_ANCHOR="remove-world-anchor"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=i,t.clone=function(e){var t=new n.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=a,t.fromValues=o,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},t.subtract=s,t.multiply=u,t.divide=l,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},t.distance=h,t.squaredDistance=c,t.squaredLength=f,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=d,t.dot=_,t.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2];return e[0]=i*u-a*s,e[1]=a*o-n*u,e[2]=n*s-i*o,e},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e},t.hermite=function(e,t,r,n,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),h=o*(3-2*a);return e[0]=t[0]*s+r[0]*u+n[0]*l+i[0]*h,e[1]=t[1]*s+r[1]*u+n[1]*l+i[1]*h,e[2]=t[2]*s+r[2]*u+n[2]*l+i[2]*h,e},t.bezier=function(e,t,r,n,i,a){var o=1-a,s=o*o,u=a*a,l=s*o,h=3*a*s,c=3*u*o,f=u*a;return e[0]=t[0]*l+r[0]*h+n[0]*c+i[0]*f,e[1]=t[1]*l+r[1]*h+n[1]*c+i[1]*f,e[2]=t[2]*l+r[2]*h+n[2]*c+i[2]*f,e},t.random=function(e,t){t=t||1;var r=2*n.RANDOM()*Math.PI,i=2*n.RANDOM()-1,a=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=i*t,e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},t.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],l=r[3],h=l*n+s*a-u*i,c=l*i+u*n-o*a,f=l*a+o*i-s*n,d=-o*n-s*i-u*a;return e[0]=h*l+d*-o+c*-u-f*-s,e[1]=c*l+d*-s+f*-o-h*-u,e[2]=f*l+d*-u+h*-s-c*-o,e},t.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},t.angle=function(e,t){var r=o(e[0],e[1],e[2]),n=o(t[0],t[1],t[2]);d(r,r),d(n,n);var i=_(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var r=e[0],i=e[1],a=e[2],o=t[0],s=t[1],u=t[2];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-u)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(4));function i(){var e=new n.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function a(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function o(e,t,r){var i=new n.ARRAY_TYPE(3);return i[0]=e,i[1]=t,i[2]=r,i}function s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function u(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function l(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function h(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function c(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function f(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function d(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function _(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}var p;t.sub=s,t.mul=u,t.div=l,t.dist=h,t.sqrDist=c,t.len=a,t.sqrLen=f,t.forEach=(p=i(),function(e,t,r,n,i,a){var o=void 0,s=void 0;for(t||(t=3),r||(r=0),s=n?Math.min(n*t+r,e.length):e.length,o=r;o<s;o+=t)p[0]=e[o],p[1]=e[o+1],p[2]=e[o+2],i(p,p,a),e[o]=p[0],e[o+1]=p[1],e[o+2]=p[2];return e})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=o(r(22)),a=o(r(0));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._fov=t,this._depthNear=r,this._depthFar=n,this._eye=o,this._viewport=new i.default(0,0,1,1),this._projectionMatrix=new Float32Array(16),this._viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),a.default.mat4_perspectiveFromFieldOfView(this._projectionMatrix,this._fov,this._depthNear,this._depthFar)}return n(e,[{key:"setProjectionMatrix",value:function(e){for(var t=0;t<16;t++)this._projectionMatrix[t]=e[t]}},{key:"setViewMatrix",value:function(e){for(var t=0;t<16;t++)this._viewMatrix[t]=e[t]}},{key:"getViewport",value:function(t){return this._eye===e.LEFT?(this._viewport.x=0,this._viewport.y=0,this._viewport.width=t.framebufferWidth/2,this._viewport.height=t.framebufferHeight):this._eye===e.RIGHT?(this._viewport.x=t.framebufferWidth/2,this._viewport.y=0,this._viewport.width=t.framebufferWidth/2,this._viewport.height=t.framebufferHeight):(this._viewport.x=0,this._viewport.y=0,this._viewport.width=t.framebufferWidth,this._viewport.height=t.framebufferHeight),this._viewport}},{key:"fov",set:function(e){this._fov=e,a.default.mat4_perspectiveFromFieldOfView(this._projectionMatrix,this._fov,this._depthNear,this._depthFar)}},{key:"eye",get:function(){return this._eye}},{key:"projectionMatrix",get:function(){return this._projectionMatrix}},{key:"viewMatrix",get:function(){return this._viewMatrix}}]),e}();t.default=s,s.LEFT="left",s.RIGHT="right",s.EYES=[s.LEFT,s.RIGHT]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=o(r(0)),a=o(r(2));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._poseModelMatrix=new Float32Array(16),i.default.mat4_fromRotationTranslation(this._poseModelMatrix,r,t)}return n(e,[{key:"_setPoseModelMatrix",value:function(e){for(var t=0;t<16;t++)this._poseModelMatrix[t]=e[t]}},{key:"_translate",value:function(e){this._poseModelMatrix[12]+=e[0],this._poseModelMatrix[13]+=e[1],this._poseModelMatrix[14]+=e[2]}},{key:"getViewMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t&&(t=new Float32Array(16)),i.default.mat4_eyeView(t,this._poseModelMatrix),t}},{key:"poseModelMatrix",get:function(){return this._poseModelMatrix}},{key:"_position",get:function(){return[this._poseModelMatrix[12],this._poseModelMatrix[13],this._poseModelMatrix[14]]},set:function(e){this._poseModelMatrix[12]=e[0],this._poseModelMatrix[13]=e[1],this._poseModelMatrix[14]=e[2]}},{key:"_orientation",get:function(){var e=new a.default;return e.setFromRotationMatrix(this._poseModelMatrix),e.toArray()},set:function(e){i.default.mat4_fromRotationTranslation(this._poseModelMatrix,e,this._position)}}]),e}();t.default=s,s.SITTING_EYE_HEIGHT=0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=r,this.z=n}return n(e,[{key:"set",value:function(e,t,r){return this.x=e,this.y=t,this.z=r,this}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"add",value:function(e,t,r){this.x+=e,this.y+=t,this.z+=r}},{key:"normalize",value:function(){var e=this.length();return 0!==e?this.multiplyScalar(1/e):(this.x=0,this.y=0,this.z=0),this}},{key:"multiplyScalar",value:function(e){this.x*=e,this.y*=e,this.z*=e}},{key:"applyQuaternion",value:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*n-o*r,l=s*r+o*t-i*n,h=s*n+i*r-a*t,c=-i*t-a*r-o*n;return this.x=u*s+c*-i+l*-o-h*-a,this.y=l*s+c*-a+h*-i-u*-o,this.z=h*s+c*-o+u*-a-l*-i,this}},{key:"applyMatrix4",value:function(e){var t=this.x,r=this.y,n=this.z,i=1/(e[3]*t+e[7]*r+e[11]*n+e[15]);return this.x=(e[0]*t+e[4]*r+e[8]*n+e[12])*i,this.y=(e[1]*t+e[5]*r+e[9]*n+e[13])*i,this.z=(e[2]*t+e[6]*r+e[10]*n+e[14])*i,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"crossVectors",value:function(e,t){var r=e.x,n=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-i*o,this.y=i*a-r*s,this.z=r*o-n*a,this}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._upDegrees=t,this._downDegrees=r,this._leftDegrees=n,this._rightDegrees=i}return n(e,[{key:"upDegrees",get:function(){return this._upDegrees}},{key:"downDegrees",get:function(){return this._downDegrees}},{key:"leftDegrees",get:function(){return this._leftDegrees}},{key:"rightDegrees",get:function(){return this._rightDegrees}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new n.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.clone=function(e){var t=new n.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,r,i,a,o,s,u,l,h,c,f,d,_,p,v){var y=new n.ARRAY_TYPE(16);return y[0]=e,y[1]=t,y[2]=r,y[3]=i,y[4]=a,y[5]=o,y[6]=s,y[7]=u,y[8]=l,y[9]=h,y[10]=c,y[11]=f,y[12]=d,y[13]=_,y[14]=p,y[15]=v,y},t.set=function(e,t,r,n,i,a,o,s,u,l,h,c,f,d,_,p,v){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=h,e[10]=c,e[11]=f,e[12]=d,e[13]=_,e[14]=p,e[15]=v,e},t.identity=i,t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=t[9],f=t[10],d=t[11],_=t[12],p=t[13],v=t[14],y=t[15],m=r*s-n*o,w=r*u-i*o,E=r*l-a*o,g=n*u-i*s,b=n*l-a*s,M=i*l-a*u,R=h*p-c*_,A=h*v-f*_,T=h*y-d*_,O=c*v-f*p,P=c*y-d*p,x=f*y-d*v,I=m*x-w*P+E*O+g*T-b*A+M*R;if(!I)return null;return I=1/I,e[0]=(s*x-u*P+l*O)*I,e[1]=(i*P-n*x-a*O)*I,e[2]=(p*M-v*b+y*g)*I,e[3]=(f*b-c*M-d*g)*I,e[4]=(u*T-o*x-l*A)*I,e[5]=(r*x-i*T+a*A)*I,e[6]=(v*E-_*M-y*w)*I,e[7]=(h*M-f*E+d*w)*I,e[8]=(o*P-s*T+l*R)*I,e[9]=(n*T-r*P-a*R)*I,e[10]=(_*b-p*E+y*m)*I,e[11]=(c*E-h*b-d*m)*I,e[12]=(s*A-o*O-u*R)*I,e[13]=(r*O-n*A+i*R)*I,e[14]=(p*w-_*g-v*m)*I,e[15]=(h*g-c*w+f*m)*I,e},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=t[9],f=t[10],d=t[11],_=t[12],p=t[13],v=t[14],y=t[15];return e[0]=s*(f*y-d*v)-c*(u*y-l*v)+p*(u*d-l*f),e[1]=-(n*(f*y-d*v)-c*(i*y-a*v)+p*(i*d-a*f)),e[2]=n*(u*y-l*v)-s*(i*y-a*v)+p*(i*l-a*u),e[3]=-(n*(u*d-l*f)-s*(i*d-a*f)+c*(i*l-a*u)),e[4]=-(o*(f*y-d*v)-h*(u*y-l*v)+_*(u*d-l*f)),e[5]=r*(f*y-d*v)-h*(i*y-a*v)+_*(i*d-a*f),e[6]=-(r*(u*y-l*v)-o*(i*y-a*v)+_*(i*l-a*u)),e[7]=r*(u*d-l*f)-o*(i*d-a*f)+h*(i*l-a*u),e[8]=o*(c*y-d*p)-h*(s*y-l*p)+_*(s*d-l*c),e[9]=-(r*(c*y-d*p)-h*(n*y-a*p)+_*(n*d-a*c)),e[10]=r*(s*y-l*p)-o*(n*y-a*p)+_*(n*l-a*s),e[11]=-(r*(s*d-l*c)-o*(n*d-a*c)+h*(n*l-a*s)),e[12]=-(o*(c*v-f*p)-h*(s*v-u*p)+_*(s*f-u*c)),e[13]=r*(c*v-f*p)-h*(n*v-i*p)+_*(n*f-i*c),e[14]=-(r*(s*v-u*p)-o*(n*v-i*p)+_*(n*u-i*s)),e[15]=r*(s*f-u*c)-o*(n*f-i*c)+h*(n*u-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],h=e[9],c=e[10],f=e[11],d=e[12],_=e[13],p=e[14],v=e[15];return(t*o-r*a)*(c*v-f*p)-(t*s-n*a)*(h*v-f*_)+(t*u-i*a)*(h*p-c*_)+(r*s-n*o)*(l*v-f*d)-(r*u-i*o)*(l*p-c*d)+(n*u-i*s)*(l*_-h*d)},t.multiply=a,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,u=void 0,l=void 0,h=void 0,c=void 0,f=void 0,d=void 0,_=void 0,p=void 0,v=void 0,y=void 0;t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],u=t[2],l=t[3],h=t[4],c=t[5],f=t[6],d=t[7],_=t[8],p=t[9],v=t[10],y=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=l,e[4]=h,e[5]=c,e[6]=f,e[7]=d,e[8]=_,e[9]=p,e[10]=v,e[11]=y,e[12]=o*n+h*i+_*a+t[12],e[13]=s*n+c*i+p*a+t[13],e[14]=u*n+f*i+v*a+t[14],e[15]=l*n+d*i+y*a+t[15]);return e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,i){var a,o,s,u,l,h,c,f,d,_,p,v,y,m,w,E,g,b,M,R,A,T,O,P,x=i[0],I=i[1],N=i[2],k=Math.sqrt(x*x+I*I+N*N);if(Math.abs(k)<n.EPSILON)return null;x*=k=1/k,I*=k,N*=k,a=Math.sin(r),o=Math.cos(r),s=1-o,u=t[0],l=t[1],h=t[2],c=t[3],f=t[4],d=t[5],_=t[6],p=t[7],v=t[8],y=t[9],m=t[10],w=t[11],E=x*x*s+o,g=I*x*s+N*a,b=N*x*s-I*a,M=x*I*s-N*a,R=I*I*s+o,A=N*I*s+x*a,T=x*N*s+I*a,O=I*N*s-x*a,P=N*N*s+o,e[0]=u*E+f*g+v*b,e[1]=l*E+d*g+y*b,e[2]=h*E+_*g+m*b,e[3]=c*E+p*g+w*b,e[4]=u*M+f*R+v*A,e[5]=l*M+d*R+y*A,e[6]=h*M+_*R+m*A,e[7]=c*M+p*R+w*A,e[8]=u*T+f*O+v*P,e[9]=l*T+d*O+y*P,e[10]=h*T+_*O+m*P,e[11]=c*T+p*O+w*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],h=t[9],c=t[10],f=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[4]=a*i+l*n,e[5]=o*i+h*n,e[6]=s*i+c*n,e[7]=u*i+f*n,e[8]=l*i-a*n,e[9]=h*i-o*n,e[10]=c*i-s*n,e[11]=f*i-u*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],h=t[9],c=t[10],f=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[0]=a*i-l*n,e[1]=o*i-h*n,e[2]=s*i-c*n,e[3]=u*i-f*n,e[8]=a*n+l*i,e[9]=o*n+h*i,e[10]=s*n+c*i,e[11]=u*n+f*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],h=t[5],c=t[6],f=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]);return e[0]=a*i+l*n,e[1]=o*i+h*n,e[2]=s*i+c*n,e[3]=u*i+f*n,e[4]=l*i-a*n,e[5]=h*i-o*n,e[6]=c*i-s*n,e[7]=f*i-u*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var i,a,o,s=r[0],u=r[1],l=r[2],h=Math.sqrt(s*s+u*u+l*l);if(Math.abs(h)<n.EPSILON)return null;return s*=h=1/h,u*=h,l*=h,i=Math.sin(t),a=Math.cos(t),o=1-a,e[0]=s*s*o+a,e[1]=u*s*o+l*i,e[2]=l*s*o-u*i,e[3]=0,e[4]=s*u*o-l*i,e[5]=u*u*o+a,e[6]=l*u*o+s*i,e[7]=0,e[8]=s*l*o+u*i,e[9]=u*l*o-s*i,e[10]=l*l*o+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,u=i+i,l=a+a,h=n*s,c=n*u,f=n*l,d=i*u,_=i*l,p=a*l,v=o*s,y=o*u,m=o*l;return e[0]=1-(d+p),e[1]=c+m,e[2]=f-y,e[3]=0,e[4]=c-m,e[5]=1-(h+p),e[6]=_+v,e[7]=0,e[8]=f+y,e[9]=_-v,e[10]=1-(h+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],h=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(u*u+l*l+h*h),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n);return e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,l=a+a,h=o+o,c=i*u,f=i*l,d=i*h,_=a*l,p=a*h,v=o*h,y=s*u,m=s*l,w=s*h,E=n[0],g=n[1],b=n[2];return e[0]=(1-(_+v))*E,e[1]=(f+w)*E,e[2]=(d-m)*E,e[3]=0,e[4]=(f-w)*g,e[5]=(1-(c+v))*g,e[6]=(p+y)*g,e[7]=0,e[8]=(d+m)*b,e[9]=(p-y)*b,e[10]=(1-(c+_))*b,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,h=o+o,c=s+s,f=a*l,d=a*h,_=a*c,p=o*h,v=o*c,y=s*c,m=u*l,w=u*h,E=u*c,g=n[0],b=n[1],M=n[2],R=i[0],A=i[1],T=i[2],O=(1-(p+y))*g,P=(d+E)*g,x=(_-w)*g,I=(d-E)*b,N=(1-(f+y))*b,k=(v+m)*b,S=(_+w)*M,C=(v-m)*M,L=(1-(f+p))*M;return e[0]=O,e[1]=P,e[2]=x,e[3]=0,e[4]=I,e[5]=N,e[6]=k,e[7]=0,e[8]=S,e[9]=C,e[10]=L,e[11]=0,e[12]=r[0]+R-(O*R+I*A+S*T),e[13]=r[1]+A-(P*R+N*A+C*T),e[14]=r[2]+T-(x*R+k*A+L*T),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,l=r*o,h=n*o,c=n*s,f=i*o,d=i*s,_=i*u,p=a*o,v=a*s,y=a*u;return e[0]=1-c-_,e[1]=h+y,e[2]=f-v,e[3]=0,e[4]=h-y,e[5]=1-l-_,e[6]=d+p,e[7]=0,e[8]=f+v,e[9]=d-p,e[10]=1-l-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),u=1/(i-n),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*l,e[15]=1,e},t.lookAt=function(e,t,r,a){var o=void 0,s=void 0,u=void 0,l=void 0,h=void 0,c=void 0,f=void 0,d=void 0,_=void 0,p=void 0,v=t[0],y=t[1],m=t[2],w=a[0],E=a[1],g=a[2],b=r[0],M=r[1],R=r[2];if(Math.abs(v-b)<n.EPSILON&&Math.abs(y-M)<n.EPSILON&&Math.abs(m-R)<n.EPSILON)return i(e);f=v-b,d=y-M,_=m-R,p=1/Math.sqrt(f*f+d*d+_*_),o=E*(_*=p)-g*(d*=p),s=g*(f*=p)-w*_,u=w*d-E*f,(p=Math.sqrt(o*o+s*s+u*u))?(o*=p=1/p,s*=p,u*=p):(o=0,s=0,u=0);l=d*u-_*s,h=_*o-f*u,c=f*s-d*o,(p=Math.sqrt(l*l+h*h+c*c))?(l*=p=1/p,h*=p,c*=p):(l=0,h=0,c=0);return e[0]=o,e[1]=l,e[2]=f,e[3]=0,e[4]=s,e[5]=h,e[6]=d,e[7]=0,e[8]=u,e[9]=c,e[10]=_,e[11]=0,e[12]=-(o*v+s*y+u*m),e[13]=-(l*v+h*y+c*m),e[14]=-(f*v+d*y+_*m),e[15]=1,e},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],u=n[1],l=n[2],h=i-r[0],c=a-r[1],f=o-r[2],d=h*h+c*c+f*f;d>0&&(d=1/Math.sqrt(d),h*=d,c*=d,f*=d);var _=u*f-l*c,p=l*h-s*f,v=s*c-u*h;(d=_*_+p*p+v*v)>0&&(d=1/Math.sqrt(d),_*=d,p*=d,v*=d);return e[0]=_,e[1]=p,e[2]=v,e[3]=0,e[4]=c*v-f*p,e[5]=f*_-h*v,e[6]=h*p-c*_,e[7]=0,e[8]=h,e[9]=c,e[10]=f,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=o,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=e[9],d=e[10],_=e[11],p=e[12],v=e[13],y=e[14],m=e[15],w=t[0],E=t[1],g=t[2],b=t[3],M=t[4],R=t[5],A=t[6],T=t[7],O=t[8],P=t[9],x=t[10],I=t[11],N=t[12],k=t[13],S=t[14],C=t[15];return Math.abs(r-w)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(i-E)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(a-g)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-b)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-M)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-R)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(R))&&Math.abs(l-A)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(h-T)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(c-O)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(f-P)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(d-x)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(_-I)<=n.EPSILON*Math.max(1,Math.abs(_),Math.abs(I))&&Math.abs(p-N)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(v-k)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(k))&&Math.abs(y-S)<=n.EPSILON*Math.max(1,Math.abs(y),Math.abs(S))&&Math.abs(m-C)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(4));function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function a(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],h=t[7],c=t[8],f=t[9],d=t[10],_=t[11],p=t[12],v=t[13],y=t[14],m=t[15],w=r[0],E=r[1],g=r[2],b=r[3];return e[0]=w*n+E*s+g*c+b*p,e[1]=w*i+E*u+g*f+b*v,e[2]=w*a+E*l+g*d+b*y,e[3]=w*o+E*h+g*_+b*m,w=r[4],E=r[5],g=r[6],b=r[7],e[4]=w*n+E*s+g*c+b*p,e[5]=w*i+E*u+g*f+b*v,e[6]=w*a+E*l+g*d+b*y,e[7]=w*o+E*h+g*_+b*m,w=r[8],E=r[9],g=r[10],b=r[11],e[8]=w*n+E*s+g*c+b*p,e[9]=w*i+E*u+g*f+b*v,e[10]=w*a+E*l+g*d+b*y,e[11]=w*o+E*h+g*_+b*m,w=r[12],E=r[13],g=r[14],b=r[15],e[12]=w*n+E*s+g*c+b*p,e[13]=w*i+E*u+g*f+b*v,e[14]=w*a+E*l+g*d+b*y,e[15]=w*o+E*h+g*_+b*m,e}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}t.mul=a,t.sub=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=u,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=l,t.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0);return r},t.multiply=h,t.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-n*s,e},t.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-a*s,e[1]=i*u+o*s,e[2]=a*u+n*s,e[3]=o*u-i*s,e},t.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e},t.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e},t.slerp=c,t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=f,t.fromEuler=function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),u=Math.cos(r),l=Math.sin(n),h=Math.cos(n);return e[0]=a*u*h-o*s*l,e[1]=o*s*h+a*u*l,e[2]=o*u*l-a*s*h,e[3]=o*u*h+a*s*l,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var n=s(r(4)),i=s(r(27)),a=s(r(12)),o=s(r(28));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function u(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function l(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function h(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],u=r[1],l=r[2],h=r[3];return e[0]=n*h+o*s+i*l-a*u,e[1]=i*h+o*u+a*s-n*l,e[2]=a*h+o*l+n*u-i*s,e[3]=o*h-n*s-i*u-a*l,e}function c(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=r[0],l=r[1],h=r[2],c=r[3],f=void 0,d=void 0,_=void 0,p=void 0,v=void 0;return(d=i*u+a*l+o*h+s*c)<0&&(d=-d,u=-u,l=-l,h=-h,c=-c),1-d>1e-6?(f=Math.acos(d),_=Math.sin(f),p=Math.sin((1-n)*f)/_,v=Math.sin(n*f)/_):(p=1-n,v=n),e[0]=p*i+v*u,e[1]=p*a+v*l,e[2]=p*o+v*h,e[3]=p*s+v*c,e}function f(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}t.clone=o.clone,t.fromValues=o.fromValues,t.copy=o.copy,t.set=o.set,t.add=o.add,t.mul=h,t.scale=o.scale,t.dot=o.dot,t.lerp=o.lerp;var d,_,p,v,y,m,w=t.length=o.length,E=(t.len=w,t.squaredLength=o.squaredLength),g=(t.sqrLen=E,t.normalize=o.normalize);t.exactEquals=o.exactEquals,t.equals=o.equals,t.rotationTo=(d=a.create(),_=a.fromValues(1,0,0),p=a.fromValues(0,1,0),function(e,t,r){var n=a.dot(t,r);return n<-.999999?(a.cross(d,_,t),a.len(d)<1e-6&&a.cross(d,p,t),a.normalize(d,d),l(e,d,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(a.cross(d,t,r),e[0]=d[0],e[1]=d[1],e[2]=d[2],e[3]=1+n,g(e,e))}),t.sqlerp=(v=u(),y=u(),function(e,t,r,n,i,a){return c(v,t,i,a),c(y,r,n,a),c(e,v,y,2*a*(1-a)),e}),t.setAxes=(m=i.create(),function(e,t,r,n){return m[0]=r[0],m[3]=r[1],m[6]=r[2],m[1]=n[0],m[4]=n[1],m[7]=n[2],m[2]=-t[0],m[5]=-t[1],m[8]=-t[2],g(e,f(e,m))})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"decodeLength",value:function(e){return e.length/4*3}},{key:"decodeArrayBuffer",value:function(e,t){var r=e.length/4*3;return t&&t.byteLength==r||(t=new ArrayBuffer(r)),this.decode(e,t),t}},{key:"removePaddingChars",value:function(e){return 64==this._keyStr.indexOf(e.charAt(e.length-1))?e.substring(0,e.length-1):e}},{key:"decode",value:function(e,t){e=this.removePaddingChars(e),e=this.removePaddingChars(e);var r,n,i,a,o,s,u,l=parseInt(e.length/4*3,10),h=0,c=0;for(r=t?new Uint8Array(t):new Uint8Array(l),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),h=0;h<l;h+=3)n=this._keyStr.indexOf(e.charAt(c++))<<2|(o=this._keyStr.indexOf(e.charAt(c++)))>>4,i=(15&o)<<4|(s=this._keyStr.indexOf(e.charAt(c++)))>>2,a=(3&s)<<6|(u=this._keyStr.indexOf(e.charAt(c++))),r[h]=n,64!=s&&(r[h+1]=i),64!=u&&(r[h+2]=a);return r}},{key:"encode",value:function(e){var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=e;e instanceof ArrayBuffer?n=new Uint8Array(arrayBuffer):e instanceof ImageData&&(n=e.data);for(var i,a=e.length,o=a%3,s=a-o,u=0;u<s;u+=3)t+=r[(16515072&(i=n[u]<<16|n[u+1]<<8|n[u+2]))>>18]+r[(258048&i)>>12]+r[(4032&i)>>6]+r[63&i];return 1==o?t+=r[(252&(i=n[s]))>>2]+r[(3&i)<<4]+"==":2==o&&(t+=r[(64512&(i=n[s]<<8|n[s+1]))>>10]+r[(1008&i)>>4]+r[(15&i)<<2]+"="),t}}]),e}();t.default=i,i._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._ambientLightIntensity=1}return n(e,[{key:"getAmbientColorTemperature",value:function(){throw new Error("Not implemented")}},{key:"ambientIntensity",set:function(e){this._ambientLightIntensity=e/1e3},get:function(){return this._ambientLightIntensity}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=o(r(0)),a=o(r(2));o(r(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._anchorUID=t,this._tempArray=new Float32Array(16),this._poseMatrix=r||i.default.mat4_generateIdentity()}return n(e,[{key:"setIdentityOffset",value:function(){var e=this._poseMatrix;e[0]=e[5]=e[10]=e[15]=1,e[1]=e[2]=e[3]=0,e[4]=e[6]=e[7]=0,e[8]=e[9]=e[11]=0,e[12]=e[13]=e[14]=0}},{key:"getOffsetTransform",value:function(e){return i.default.mat4_multiply(this._tempArray,this._poseMatrix,e._poseModelMatrix)}},{key:"anchorUID",get:function(){return this._anchorUID}},{key:"poseMatrix",get:function(){return this._poseMatrix},set:function(e){for(var t=0;t<16;t++)this._poseMatrix[t]=e[t]}},{key:"position",get:function(){return new Float32Array([this._poseMatrix[12],this._poseMatrix[13],this._poseMatrix[14]])}},{key:"orientation",get:function(){var e=new a.default;return e.setFromRotationMatrix(this._poseMatrix),e.toArray()}}]),e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._x=t,this._y=r,this._width=n,this._height=i}return n(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._y=e}},{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(3);var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((n=i)&&n.__esModule?n:{default:n}).default);t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=u(r(3)),a=u(r(15)),o=u(r(2)),s=u(r(38));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._deviceOrientation=null,e._windowOrientation=0,window.addEventListener("orientationchange",(function(){e._windowOrientation=window.orientation||0}),!1),window.addEventListener("deviceorientation",(function(r){e._deviceOrientation=r;try{e.dispatchEvent(new CustomEvent(t.ORIENTATION_UPDATE_EVENT,{deviceOrientation:e._deviceOrientation,windowOrientation:e._windowOrientation}))}catch(e){console.error("deviceorientation event handler error",e)}}),!1),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"getOrientation",value:function(e){return null===this._deviceOrientation?(e.set(0,0,0,1),!1):(t.WORKING_EULER.set(this._deviceOrientation.beta*t.DEG_TO_RAD,this._deviceOrientation.alpha*t.DEG_TO_RAD,-1*this._deviceOrientation.gamma*t.DEG_TO_RAD,"YXZ"),e.setFromEuler(t.WORKING_EULER.x,t.WORKING_EULER.y,t.WORKING_EULER.z,t.WORKING_EULER.order),e.multiply(t.HALF_PI_AROUND_X),e.multiply(t.WORKING_QUATERNION.setFromAxisAngle(t.Z_AXIS,-this._windowOrientation*t.DEG_TO_RAD)),!0)}}]),t}(i.default);t.default=l,l.ORIENTATION_UPDATE_EVENT="orientation-update",l.Z_AXIS=new a.default(0,0,1),l.WORKING_EULER=new s.default,l.WORKING_QUATERNION=new o.default,l.HALF_PI_AROUND_X=new o.default(-Math.sqrt(.5),0,0,Math.sqrt(.5)),l.DEG_TO_RAD=Math.PI/180},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=x(r(6)),a=x(r(11)),o=x(r(29)),s=x(r(7)),u=x(r(30)),l=x(r(20)),h=x(r(1)),c=x(r(10)),f=x(r(8)),d=x(r(9)),_=x(r(21)),p=x(r(31)),v=x(r(32)),y=x(r(33)),m=x(r(13)),w=x(r(22)),E=x(r(34)),g=x(r(14)),b=x(r(23)),M=x(r(35)),R=x(r(36)),A=x(r(3)),T=x(r(37)),O=x(r(39)),P=x(r(40));function x(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));window.XRDisplay=i.default,window.XRSession=a.default,window.XRSessionCreateParameters=o.default,window.Reality=s.default,window.XRPointCloud=u.default,window.XRLightEstimate=l.default,window.XRAnchor=h.default,window.XRPlaneAnchor=c.default,window.XRFaceAnchor=f.default,window.XRImageAnchor=d.default,window.XRAnchorOffset=_.default,window.XRStageBounds=p.default,window.XRStageBoundsPoint=v.default,window.XRPresentationFrame=y.default,window.XRView=m.default,window.XRViewport=w.default,window.XRCoordinateSystem=E.default,window.XRViewPose=g.default,window.XRLayer=b.default,window.XRWebGLLayer=M.default,window.XRVideoFrame=R.default,XRDisplay=window.XRDisplay,XRSession=window.XRSession,XRSessionCreateParameters=window.XRSessionCreateParameters,Reality=window.Reality,XRPointCloud=window.XRPointCloud,XRLightEstimate=window.XRLightEstimate,XRAnchor=window.XRAnchor,XRPlaneAnchor=window.XRPlaneAnchor,XRFaceAnchor=window.XRFaceAnchor,XRImageAnchor=window.XRImageAnchor,XRAnchorOffset=window.XRAnchorOffset,XRStageBounds=window.XRStageBounds,XRStageBoundsPoint=window.XRStageBoundsPoint,XRPresentationFrame=window.XRPresentationFrame,XRView=window.XRView,XRViewport=window.XRViewport,XRCoordinateSystem=window.XRCoordinateSystem,XRViewPose=window.XRViewPose,XRLayer=window.XRLayer,XRWebGLLayer=window.XRWebGLLayer,XRVideoFrame=window.XRVideoFrame,e._getVRDisplaysFinished=!1,e._sharedRealities=[new P.default(e)],e._privateRealities=[],e._displays=[new T.default(e,e._sharedRealities[0])],"function"==typeof navigator.getVRDisplays?navigator.getVRDisplays().then((function(t){var r=!0,n=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;null!==s&&(s.capabilities.canPresent&&e._displays.push(new O.default(e,e._sharedRealities[0],s)))}}catch(e){n=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}e._getVRDisplaysFinished=!0})):e._getVRDisplaysFinished=!0,e._sessionEls=document.createElement("div"),e._sessionEls.setAttribute("class","webxr-sessions"),e._realityEls=document.createElement("div"),e._realityEls.setAttribute("class","webxr-realities");for(var r=[e._sessionEls,e._realityEls],n=0;n<r.length;n++){var A=r[n];A.style.position="absolute",A.style.width="100%",A.style.height="100%"}var x=function(){document.body.style.width="100%",document.body.style.height="100%",document.body.prepend(e._sessionEls),document.body.prepend(e._realityEls)};return"loading"!==document.readyState?x():document.addEventListener("DOMContentLoaded",x),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"getDisplays",value:function(){var e=this;return new Promise((function(t,r){!function t(r){e._getVRDisplaysFinished?r(e._displays):setTimeout(t.bind(e,r),30)}(t)}))}}]),t}(A.default);void 0===navigator.XR&&(navigator.XR=new I)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(7);var o=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"Virtual",!1,!1))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"_start",value:function(e){}},{key:"_stop",value:function(){}},{key:"_handleNewFrame",value:function(){}},{key:"_addAnchor",value:function(e,t){return this._anchors.set(e.uid,e),e.uid}},{key:"_findAnchor",value:function(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(e,t){e(null)}))}},{key:"_removeAnchor",value:function(e){this._anchors.delete(e)}},{key:"_hitTestNoAnchor",value:function(e,t,r){return null}},{key:"_getHasLightEstimate",value:function(){return!1}},{key:"_findFloorAnchor",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new Float32Array(e._headPose.poseModelMatrix);return new Promise((function(i,a){n[13]=0;var o=new XRCoordinateSystem(e,XRCoordinateSystem.TRACKER);o._relativeMatrix=n;var s=new XRAnchor(o,r);t._addAnchor(s,e),i(new XRAnchorOffset(s.uid))}))}},{key:"_getTimeStamp",value:function(e){return e}}]),t}(((n=a)&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new n.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new n.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,r,i,a,o,s,u,l){var h=new n.ARRAY_TYPE(9);return h[0]=e,h[1]=t,h[2]=r,h[3]=i,h[4]=a,h[5]=o,h[6]=s,h[7]=u,h[8]=l,h},t.set=function(e,t,r,n,i,a,o,s,u,l){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=h*o-s*l,f=-h*a+s*u,d=l*a-o*u,_=r*c+n*f+i*d;if(!_)return null;return _=1/_,e[0]=c*_,e[1]=(-h*n+i*l)*_,e[2]=(s*n-i*o)*_,e[3]=f*_,e[4]=(h*r-i*u)*_,e[5]=(-s*r+i*a)*_,e[6]=d*_,e[7]=(-l*r+n*u)*_,e[8]=(o*r-n*a)*_,e},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8];return e[0]=o*h-s*l,e[1]=i*l-n*h,e[2]=n*s-i*o,e[3]=s*u-a*h,e[4]=r*h-i*u,e[5]=i*a-r*s,e[6]=a*l-o*u,e[7]=n*u-r*l,e[8]=r*o-n*a,e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*(l*a-o*u)+r*(-l*i+o*s)+n*(u*i-a*s)},t.multiply=i,t.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],h=t[7],c=t[8],f=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=f*n+d*o+l,e[7]=f*i+d*s+h,e[8]=f*a+d*u+c,e},t.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],h=t[7],c=t[8],f=Math.sin(r),d=Math.cos(r);return e[0]=d*n+f*o,e[1]=d*i+f*s,e[2]=d*a+f*u,e[3]=d*o-f*n,e[4]=d*s-f*i,e[5]=d*u-f*a,e[6]=l,e[7]=h,e[8]=c,e},t.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,l=r*o,h=n*o,c=n*s,f=i*o,d=i*s,_=i*u,p=a*o,v=a*s,y=a*u;return e[0]=1-c-_,e[3]=h-y,e[6]=f+v,e[1]=h+y,e[4]=1-l-_,e[7]=d-p,e[2]=f-v,e[5]=d+p,e[8]=1-l-c,e},t.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],h=t[8],c=t[9],f=t[10],d=t[11],_=t[12],p=t[13],v=t[14],y=t[15],m=r*s-n*o,w=r*u-i*o,E=r*l-a*o,g=n*u-i*s,b=n*l-a*s,M=i*l-a*u,R=h*p-c*_,A=h*v-f*_,T=h*y-d*_,O=c*v-f*p,P=c*y-d*p,x=f*y-d*v,I=m*x-w*P+E*O+g*T-b*A+M*R;if(!I)return null;return I=1/I,e[0]=(s*x-u*P+l*O)*I,e[1]=(u*T-o*x-l*A)*I,e[2]=(o*P-s*T+l*R)*I,e[3]=(i*P-n*x-a*O)*I,e[4]=(r*x-i*T+a*A)*I,e[5]=(n*T-r*P-a*R)*I,e[6]=(p*M-v*b+y*g)*I,e[7]=(v*E-_*M-y*w)*I,e[8]=(_*b-p*E+y*m)*I,e},t.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},t.subtract=a,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=t[0],d=t[1],_=t[2],p=t[3],v=t[4],y=t[5],m=t[6],w=t[7],E=t[8];return Math.abs(r-f)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-d)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-_)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(o-p)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-v)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-y)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-m)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(h-w)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(c-E)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(4));function i(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],h=t[7],c=t[8],f=r[0],d=r[1],_=r[2],p=r[3],v=r[4],y=r[5],m=r[6],w=r[7],E=r[8];return e[0]=f*n+d*o+_*l,e[1]=f*i+d*s+_*h,e[2]=f*a+d*u+_*c,e[3]=p*n+v*o+y*l,e[4]=p*i+v*s+y*h,e[5]=p*a+v*u+y*c,e[6]=m*n+w*o+E*l,e[7]=m*i+w*s+E*h,e[8]=m*a+w*u+E*c,e}function a(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}t.mul=i,t.sub=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=i,t.clone=function(e){var t=new n.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,r,i){var a=new n.ARRAY_TYPE(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},t.subtract=a,t.multiply=o,t.divide=s,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},t.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=u,t.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},t.distance=l,t.squaredDistance=h,t.length=c,t.squaredLength=f,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=d,t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e},t.random=function(e,t){return t=t||1,e[0]=n.RANDOM(),e[1]=n.RANDOM(),e[2]=n.RANDOM(),e[3]=n.RANDOM(),d(e,e),u(e,e,t),e},t.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e},t.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2],l=r[3],h=l*n+s*a-u*i,c=l*i+u*n-o*a,f=l*a+o*i-s*n,d=-o*n-s*i-u*a;return e[0]=h*l+d*-o+c*-u-f*-s,e[1]=c*l+d*-s+f*-o-h*-u,e[2]=f*l+d*-u+h*-s-c*-o,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=t[0],u=t[1],l=t[2],h=t[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-h)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(4));function i(){var e=new n.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function a(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function o(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function s(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function l(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function h(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function c(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function f(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function d(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}var _;t.sub=a,t.mul=o,t.div=s,t.dist=l,t.sqrDist=h,t.len=c,t.sqrLen=f,t.forEach=(_=i(),function(e,t,r,n,i,a){var o=void 0,s=void 0;for(t||(t=4),r||(r=0),s=n?Math.min(n*t+r,e.length):e.length,o=r;o<s;o+=t)_[0]=e[o],_[1]=e[o+1],_[2]=e[o+2],_[3]=e[o+3],i(_,_,a),e[o]=_[0],e[o+1]=_[1],e[o+2]=_[2],e[o+3]=_[3];return e})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"exclusive",get:function(){throw"Not implemented"}},{key:"type",get:function(){throw"Not implemented"}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"points",get:function(){throw new Error("Not implemented")}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"center",get:function(){throw new Error("Not implemented")}},{key:"geometry",get:function(){throw new Error("Not implemented")}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"x",get:function(){throw new Error("Not implemented")}},{key:"y",get:function(){throw new Error("Not implemented")}}]),e}();t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=s(r(1)),a=s(r(5)),o=s(r(0));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._session=t,this._timestamp=this._session.reality._getTimeStamp(r)}return n(e,[{key:"addAnchor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0,1],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=o.default.mat4_fromRotationTranslation(new Float32Array(16),r,t);o.default.mat4_multiply(a,e.getTransformTo(this._session._display._trackerCoordinateSystem),a);var s=new XRCoordinateSystem(this._session._display,XRCoordinateSystem.TRACKER);return s._relativeMatrix=a,this._session.reality._addAnchor(new i.default(s,n),this._session.display)}},{key:"findAnchor",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this._session.reality._findAnchor(e,t,this._session.display,r)}},{key:"hitTestNoAnchor",value:function(e,t){return this._session.reality._hitTestNoAnchor(e,t,this._session.display)}},{key:"findFloorAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._session.reality._findFloorAnchor(this._session.display,e)}},{key:"removeAnchor",value:function(e){return this._session.reality._removeAnchor(e)}},{key:"getAnchor",value:function(e){return this._session.reality._getAnchor(e)}},{key:"getCoordinateSystem",value:function(){var e;return(e=this._session)._getCoordinateSystem.apply(e,arguments)}},{key:"getDisplayPose",value:function(e){switch(e._type){case XRCoordinateSystem.HEAD_MODEL:return this._session._display._headPose;case XRCoordinateSystem.EYE_LEVEL:return this._session._display._eyeLevelPose;default:return null}}},{key:"session",get:function(){return this._session}},{key:"views",get:function(){return this._session._display._views}},{key:"hasPointCloud",get:function(){return!1}},{key:"pointCloud",get:function(){return null}},{key:"hasLightEstimate",get:function(){return this._session.reality._getHasLightEstimate()}},{key:"lightEstimate",get:function(){return this._session.reality._getLightAmbientIntensity()}},{key:"timestamp",get:function(){return this._timestamp}},{key:"anchors",get:function(){var e=[],t=!0,r=!1,n=void 0;try{for(var i,a=this._session.reality._anchors.values()[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;e.push(o)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e}}]),e}();t.default=u,u.HIT_TEST_TYPE_FEATURE_POINT=a.default.HIT_TEST_TYPE_FEATURE_POINT,u.HIT_TEST_TYPE_ESTIMATED_HORIZONTAL_PLANE=a.default.HIT_TEST_TYPE_ESTIMATED_HORIZONTAL_PLANE,u.HIT_TEST_TYPE_ESTIMATED_VERTICAL_PLANE=a.default.HIT_TEST_TYPE_ESTIMATED_VERTICAL_PLANE,u.HIT_TEST_TYPE_EXISTING_PLANE=a.default.HIT_TEST_TYPE_EXISTING_PLANE,u.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT=a.default.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT,u.HIT_TEST_TYPE_EXISTING_PLANE_USING_GEOMETRY=a.default.HIT_TEST_TYPE_EXISTING_PLANE_USING_GEOMETRY,u.HIT_TEST_TYPE_ALL=a.default.HIT_TEST_TYPE_FEATURE_POINT|a.default.HIT_TEST_TYPE_EXISTING_PLANE|a.default.HIT_TEST_TYPE_ESTIMATED_HORIZONTAL_PLANE|a.default.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT,u.HIT_TEST_TYPE_EXISTING_PLANES=a.default.HIT_TEST_TYPE_EXISTING_PLANE|a.default.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),o=(n=a)&&n.__esModule?n:{default:n};var s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._display=t,this._type=r,this.__relativeMatrix=o.default.mat4_generateIdentity(),this._workingMatrix=o.default.mat4_generateIdentity()}return i(e,[{key:"getTransformTo",value:function(e){var t=o.default.mat4_invert(new Float32Array(16),e._poseModelMatrix),r=o.default.mat4_generateIdentity();return o.default.mat4_multiply(r,t,r),o.default.mat4_multiply(r,this._poseModelMatrix,r),r}},{key:"_relativeMatrix",get:function(){return this.__relativeMatrix},set:function(e){for(var t=0;t<16;t++)this.__relativeMatrix[t]=e[t]}},{key:"_poseModelMatrix",get:function(){switch(this._type){case e.HEAD_MODEL:return this._display._headPose.poseModelMatrix;case e.EYE_LEVEL:return this._display._eyeLevelPose.poseModelMatrix;case e.TRACKER:return o.default.mat4_multiply(this._workingMatrix,this.__relativeMatrix,this._display._trackerPoseModelMatrix),this._workingMatrix;default:throw new Error("Unknown coordinate system type: "+this._type)}}}]),e}();t.default=s,s.HEAD_MODEL="headModel",s.EYE_LEVEL="eyeLevel",s.TRACKER="tracker",s.TYPES=[s.HEAD_MODEL,s.EYE_LEVEL,s.TRACKER]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(23);var o=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._session=e,n._context=r,n._width=n._context.canvas.width,n._height=n._context.canvas.height,n._framebuffer=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"requestViewportScaling",value:function(e){throw"Not implemented"}},{key:"context",get:function(){return this._context}},{key:"antialias",get:function(){throw"Not implemented"}},{key:"depth",get:function(){throw"Not implemented"}},{key:"stencil",get:function(){throw"Not implemented"}},{key:"alpha",get:function(){throw"Not implemented"}},{key:"multiview",get:function(){throw"Not implemented"}},{key:"framebuffer",get:function(){return this._framebuffer}},{key:"framebufferWidth",set:function(e){this._width=e,this._context.canvas.width=e},get:function(){return this._width}},{key:"framebufferHeight",set:function(e){this._height=e,this._context.canvas.height=e},get:function(){return this._height}}]),t}(((n=a)&&n.__esModule?n:{default:n}).default);t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=(s(r(4)),s(r(17)),s(r(18)),s(r(12)),r(19)),o=(n=a)&&n.__esModule?n:{default:n};function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var u=[],l=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._buffers=t;for(var a=0;a<t.length;a++)if(t[a]._buffer=t[a].buffer,t[a].buffer=null,t[a]._abCache||"string"!=typeof t[a]._buffer){if(!t[a]._abCache&&t[a]._buffer instanceof ImageData){var s=t[a]._buffer.data;for(f=s.length,d=0;d<u.length;d++)if(u[d].byteLength==f){t[a]._abCache=u[d],u.splice(d,1);break}var l=t[a]._abCache?t[a]._abCache:new ArrayBuffer(f);t[a]._abCache=null;for(var h=new Uint8Array(l),c=0;c<f;c++)h[c]=s[c];t[a]._buffer=l}}else for(var f=o.default.decodeLength(t[a]._buffer),d=0;d<u.length;d++)if(u[d].byteLength==f){t[a]._abCache=u[d],u.splice(d,1);break}this._pixelFormat=r,this._timestamp=n,this._camera=i}return i(e,[{key:"numBuffers",value:function(){this._buffers.length}},{key:"buffer",value:function(e){if(e>=0&&e<this._buffers.length){var t=this._buffers[e];return t.buffer||("string"==typeof t._buffer?(t._buffer=o.default.decodeArrayBuffer(t._buffer,t._abCache),t._abCache=null,t.buffer=new Uint8Array(t._buffer)):t._buffer instanceof ArrayBuffer?t.buffer=new Uint8Array(t._buffer):t._buffer instanceof ImageData&&(t.buffer=ImageData.data)),t}return null}},{key:"release",value:function(){for(var e=this._buffers,t=0;t<e.length;t++)e[t]._buffer instanceof ArrayBuffer&&e[t]._buffer.byteLength>0&&u.push(e[t]._buffer),e[t]._abCache instanceof ArrayBuffer&&e[t]._abCache.byteLength>0&&u.push(e[t]._abCache)}},{key:"postMessageToWorker",value:function(e,t){var r=Object.assign({},t||{});r.buffers=this._buffers,r.timestamp=this._timestamp,r.pixelFormat=this._pixelFormat,r.camera=this._camera;for(var n=[],i=0;i<r.buffers.length;i++)r.buffers[i].buffer=r.buffers[i]._buffer,(r.buffers[i]._buffer instanceof ArrayBuffer||r.buffers[i]._buffer instanceof ImageData)&&n.push(r.buffers[i]._buffer),r.buffers[i]._buffer=null,r.buffers[i]._abCache instanceof ArrayBuffer&&n.push(r.buffers[i]._abCache);e.postMessage(r,n)}},{key:"postReplyMessage",value:function(e){var t=Object.assign({},e);t.buffers=this._buffers,t.timestamp=this._timestamp,t.pixelFormat=this._pixelFormat,t.camera=this._camera;for(var r=[],n=0;n<t.buffers.length;n++)t.buffers[n].buffer=null,(t.buffers[n]._buffer instanceof ArrayBuffer||t.buffers[n]._buffer instanceof ImageData)&&(r.push(t.buffers[n]._buffer),t.buffers[n].buffer=t.buffers[n]._buffer),t.buffers[n]._buffer=null,t.buffers[n]._abCache instanceof ArrayBuffer&&r.push(t.buffers[n]._abCache);postMessage(t,r)}},{key:"pixelFormat",get:function(){return this._pixelFormat}},{key:"timestamp",get:function(){return this._timestamp}},{key:"camera",get:function(){return this._camera}}],[{key:"createFromMessage",value:function(e){return new this(e.data.buffers,e.data.pixelFormat,e.data.timestamp,e.data.camera)}}]),e}();t.default=l,l.IMAGEFORMAT_RGBA32="RGBA32",l.IMAGEFORMAT_BGRA32="BGRA32",l.IMAGEFORMAT_RGB24="RGB24",l.IMAGEFORMAT_BGR24="BGR24",l.IMAGEFORMAT_GRAY8="GRAY8",l.IMAGEFORMAT_YUV444P="YUV444P",l.IMAGEFORMAT_YUV422P="YUV422P",l.IMAGEFORMAT_YUV420P="YUV420P",l.IMAGEFORMAT_YUV420SP_NV12="YUV420SP_NV12",l.IMAGEFORMAT_YUV420SP_NV21="YUV420SP_NV21",l.IMAGEFORMAT_HSV="HSV",l.IMAGEFORMAT_Lab="Lab",l.IMAGEFORMAT_DEPTH="DEPTH",l.IMAGEFORMAT_NULL="",l.IMAGEFORMAT=[l.IMAGEFORMAT_RGBA32,l.IMAGEFORMAT_BGRA32,l.IMAGEFORMAT_RGB24,l.IMAGEFORMAT_BGR24,l.IMAGEFORMAT_GRAY8,l.IMAGEFORMAT_YUV444P,l.IMAGEFORMAT_YUV422P,l.IMAGEFORMAT_YUV420P,l.IMAGEFORMAT_YUV420SP_NV12,l.IMAGEFORMAT_YUV420SP_NV21,l.IMAGEFORMAT_HSV,l.IMAGEFORMAT_Lab,l.IMAGEFORMAT_DEPTH,l.IMAGEFORMAT_NULL]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},a=m(r(6)),o=m(r(13)),s=m(r(11)),u=m(r(16)),l=m(r(0)),h=m(r(2)),c=m(r(15)),f=m(r(24)),d=m(r(5)),_=m(r(10)),p=m(r(8)),v=m(r(1)),y=m(r(9));function m(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var E=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"Flat",!1,r));return n._started=!1,n._initialized=!1,n._arKitWrapper=null,n._vrFrameData=null,n._deviceOrientationTracker=null,n._deviceOrientation=null,n._devicePosition=null,n._deviceWorldMatrix=null,n._views.push(new o.default(n._fov,n._depthNear,n._depthFar)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"_start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._reality._vrDisplay?null===this._vrFrameData&&(this._vrFrameData=new VRFrameData,this._views[0]._depthNear=this._reality._vrDisplay.depthNear,this._views[0]._depthFar=this._reality._vrDisplay.depthFar,this._deviceOrientation=new h.default,this._devicePosition=new c.default,this._deviceWorldMatrix=new Float32Array(16)):d.default.HasARKit()?!1===this._initialized&&(this._initialized=!0,this._arKitWrapper=d.default.GetOrCreate(),this._arKitWrapper.addEventListener(d.default.INIT_EVENT,this._handleARKitInit.bind(this)),this._arKitWrapper.addEventListener(d.default.WATCH_EVENT,this._handleARKitUpdate.bind(this)),this._arKitWrapper.addEventListener(d.default.WINDOW_RESIZE_EVENT,this._handleARKitWindowResize.bind(this)),this._arKitWrapper.addEventListener(d.default.ON_ERROR,this._handleOnError.bind(this)),this._arKitWrapper.addEventListener(d.default.AR_TRACKING_CHANGED,this._handleArTrackingChanged.bind(this)),this._arKitWrapper.addEventListener(d.default.COMPUTER_VISION_DATA,this._handleComputerVisionData.bind(this)),this._reality.addEventListener(Reality.NEW_WORLD_ANCHOR,this._handleNewWorldAnchor.bind(this)),this._reality.addEventListener(Reality.UPDATE_WORLD_ANCHOR,this._handleUpdateWorldAnchor.bind(this)),this._reality.addEventListener(Reality.REMOVE_WORLD_ANCHOR,this._handleRemoveWorldAnchor.bind(this)),this._arKitWrapper.waitForInit().then((function(){}))):!1===this._initialized&&(this._initialized=!0,this._deviceOrientation=new h.default,this._devicePosition=new c.default,this._deviceWorldMatrix=new Float32Array(16),this._deviceOrientationTracker=new f.default,this._deviceOrientationTracker.addEventListener(f.default.ORIENTATION_UPDATE_EVENT,this._updateFromDeviceOrientationTracker.bind(this)),this._reality.addEventListener(Reality.COMPUTER_VISION_DATA,this._handleComputerVisionData.bind(this)),this._reality.addEventListener(Reality.WINDOW_RESIZE_EVENT,this._handleWindowResize.bind(this))),this.running=!0,this._reality._start(e)}},{key:"_stop",value:function(){!1!==this.running&&(this.running=!1,this._reality._stop())}},{key:"_fixFov",value:function(e,t,r){if(this.baseLayer){r/=e/this.baseLayer._context.canvas.clientWidth;var n=.5*this.baseLayer._context.canvas.clientWidth/r,i=180/Math.PI*2*Math.atan(n),a=.5*this.baseLayer._context.canvas.clientHeight/r,o=180/Math.PI*2*Math.atan(a);this._fov=new u.default(o/2,o/2,i/2,i/2),this._views[0].fov=this._fov}}},{key:"_handleWindowResize",value:function(e){this._fixFov(e.detail.width,e.detail.height,e.detail.focalLength)}},{key:"_handleNewWorldAnchor",value:function(e){var t=e.detail,r=new XRCoordinateSystem(this,XRCoordinateSystem.TRACKER);r._relativeMatrix=t.transform;var n=void 0;switch(t.type){case d.default.ANCHOR_TYPE_PLANE:n=new _.default(r,t.uuid,t.plane_center,[t.plane_extent.x,t.plane_extent.z],t.plane_alignment,t.geometry);break;case d.default.ANCHOR_TYPE_FACE:n=new p.default(r,t.uuid,t.geometry,t.blendShapes);break;case d.default.ANCHOR_TYPE_ANCHOR:n=new v.default(r,t.uuid);break;case d.default.ANCHOR_TYPE_IMAGE:n=new y.default(r,t.uuid)}this._reality._anchors.set(t.uuid,n);try{this.dispatchEvent(new CustomEvent(a.default.NEW_WORLD_ANCHOR,{source:this,detail:n}))}catch(e){console.error("NEW_WORLD_ANCHOR event error",e)}}},{key:"_handleUpdateWorldAnchor",value:function(e){var t=e.detail,r=this._reality._anchors.get(t);if(null!==r)try{this.dispatchEvent(new CustomEvent(a.default.UPDATE_WORLD_ANCHOR,{source:this,detail:r}))}catch(e){console.error("UPDATE_WORLD_ANCHOR event error",e)}}},{key:"_handleRemoveWorldAnchor",value:function(e){var t=e.detail,r=this._reality._anchors.get(t);if(null!==r)try{this.dispatchEvent(new CustomEvent(a.default.REMOVE_WORLD_ANCHOR,{source:this,detail:r}))}catch(e){console.error("REMOVE_WORLD_ANCHOR event error",e)}}},{key:"_handleNewBaseLayer",value:function(e){this.baseLayer=e,e._context.canvas.style.width="100%",e._context.canvas.style.height="100%",e.framebufferWidth=this._xr._sessionEls.clientWidth,e.framebufferHeight=this._xr._sessionEls.clientHeight,null===this._arKitWrapper&&window.addEventListener("resize",(function(){e.framebufferWidth=e._context.canvas.clientWidth,e.framebufferHeight=e._context.canvas.clientHeight}),!1),this._xr._sessionEls.appendChild(e._context.canvas)}},{key:"_handleNewFrame",value:function(e){null!==this._vrFrameData&&this._updateFromVRDevice()}},{key:"_updateFromVRDevice",value:function(){var e,t;this._reality._vrDisplay.getFrameData(this._vrFrameData),this._views[0].setProjectionMatrix(this._vrFrameData.leftProjectionMatrix),(e=this._deviceOrientation).set.apply(e,w(this._vrFrameData.pose.orientation)),(t=this._devicePosition).set.apply(t,w(this._vrFrameData.pose.position)),this._devicePosition.add(0,XRViewPose.SITTING_EYE_HEIGHT,0),l.default.mat4_fromRotationTranslation(this._deviceWorldMatrix,this._deviceOrientation.toArray(),this._devicePosition.toArray()),this._views[0].setViewMatrix(this._deviceWorldMatrix),this._headPose._setPoseModelMatrix(this._deviceWorldMatrix),this._eyeLevelPose._position=this._devicePosition.toArray()}},{key:"_updateFromDeviceOrientationTracker",value:function(){this._deviceOrientationTracker.getOrientation(this._deviceOrientation),this._devicePosition.set(this._headPose.poseModelMatrix[12],this._headPose.poseModelMatrix[13],this._headPose.poseModelMatrix[14]),this._devicePosition.add(0,XRViewPose.SITTING_EYE_HEIGHT,0),l.default.mat4_fromRotationTranslation(this._deviceWorldMatrix,this._deviceOrientation.toArray(),this._devicePosition.toArray()),this._headPose._setPoseModelMatrix(this._deviceWorldMatrix),this._views[0].setViewMatrix(this._deviceWorldMatrix),this._eyeLevelPose._position=this._devicePosition.toArray()}},{key:"_handleARKitUpdate",value:function(){var e=this._arKitWrapper.getData("camera_transform");e?(this._headPose._setPoseModelMatrix(e),this._views[0].setViewMatrix(e),this._headPose._poseModelMatrix[13]+=XRViewPose.SITTING_EYE_HEIGHT,this._eyeLevelPose._position=this._headPose._position):console.log("no camera transform",this._arKitWrapper.rawARData);var t=this._arKitWrapper.getData("projection_camera");t?this._views[0].setProjectionMatrix(t):console.log("no projection camera",this._arKitWrapper.rawARData)}},{key:"_handleARKitInit",value:function(e){}},{key:"_handleARKitWindowResize",value:function(e){this.baseLayer.framebufferWidth=e.detail.width,this.baseLayer.framebufferHeight=e.detail.height}},{key:"_handleOnError",value:function(e){}},{key:"_handleArTrackingChanged",value:function(e){try{this.dispatchEvent(new CustomEvent(a.default.TRACKING_CHANGED,{source:this,detail:e.detail[0]}))}catch(e){console.error("trackingChanged callback error",e)}}},{key:"_handleComputerVisionData",value:function(e){try{this.dispatchEvent(new CustomEvent(a.default.VIDEO_FRAME,{source:this,detail:e.detail}))}catch(e){console.error("computer vision callback error",e)}}},{key:"_requestVideoFrame",value:function(){this._arKitWrapper?this._arKitWrapper._requestComputerVisionData():this._reality._requestVideoFrame()}},{key:"_stopVideoFrames",value:function(){this._arKitWrapper?this._arKitWrapper._stopSendingComputerVisionData():this._reality._stopVideoFrames()}},{key:"_startVideoFrames",value:function(){this._arKitWrapper?this._arKitWrapper._startSendingComputerVisionData():this._reality._startVideoFrames()}},{key:"_createSession",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this._start(r),d.default.HasARKit()?this._arKitWrapper.waitForInit().then((function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createSession",e).call(e,r)})):i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_createSession",this).call(this,r)}},{key:"_supportedCreationParameters",value:function(e){return e.type===s.default.AUGMENTATION&&!1===e.exclusive}}]),t}(a.default);t.default=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=r,this.z=n,this.order=i}return n(e,[{key:"set",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;this.x=t,this.y=r,this.z=n,this.order=i}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}}]),e}();t.default=i,i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i.DefaultOrder="XYZ"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=h(r(6)),a=h(r(13)),o=h(r(11)),s=(h(r(14)),h(r(0))),u=h(r(2)),l=h(r(15));h(r(24)),h(r(5));function h(e){return e&&e.__esModule?e:{default:e}}function c(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var f=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n.displayName,n.capabilities.hasExternalDisplay,r));return i._vrDisplay=n,i._vrFrameData=new VRFrameData,i._leftView=new a.default(i._fov,i._depthNear,i._depthFar,a.default.LEFT),i._rightView=new a.default(i._fov,i._depthNear,i._depthFar,a.default.RIGHT),i._views=[i._leftView,i._rightView],i._deviceOrientation=new u.default,i._devicePosition=new l.default,i._deviceWorldMatrix=new Float32Array(16),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"_requestAnimationFrame",value:function(e){this._vrDisplay.isPresenting?this._vrDisplay.requestAnimationFrame(e):window.requestAnimationFrame(e)}},{key:"_handleNewBaseLayer",value:function(e){var t=this;this._vrDisplay.requestPresent([{source:e._context.canvas}]).then((function(){var r=t._vrDisplay.getEyeParameters("left"),n=t._vrDisplay.getEyeParameters("right");e.framebufferWidth=2*Math.max(r.renderWidth,n.renderWidth),e.framebufferHeight=Math.max(r.renderHeight,n.renderHeight),e._context.canvas.style.position="absolute",e._context.canvas.style.bottom="1px",e._context.canvas.style.right="1px",e._context.canvas.style.width="100%",e._context.canvas.style.height="100%",document.body.appendChild(e._context.canvas)})).catch((function(e){console.error("Unable to init WebVR 1.1 display",e)}))}},{key:"_stop",value:function(){!1!==this.running&&(this.running=!1,this._reality._stop())}},{key:"_handleNewFrame",value:function(e){this._vrDisplay.isPresenting&&this._updateFromVRFrameData()}},{key:"_handleAfterFrame",value:function(e){this._vrDisplay.isPresenting&&this._vrDisplay.submitFrame()}},{key:"_supportedCreationParameters",value:function(e){return e.type===o.default.REALITY&&!0===e.exclusive}},{key:"_updateFromVRFrameData",value:function(){if(this._vrDisplay.getFrameData(this._vrFrameData),this._leftView.setViewMatrix(this._vrFrameData.leftViewMatrix),this._rightView.setViewMatrix(this._vrFrameData.rightViewMatrix),this._leftView.setProjectionMatrix(this._vrFrameData.leftProjectionMatrix),this._rightView.setProjectionMatrix(this._vrFrameData.rightProjectionMatrix),this._vrFrameData.pose){var e,t;if(this._vrFrameData.pose.orientation)(e=this._deviceOrientation).set.apply(e,c(this._vrFrameData.pose.orientation));if(this._vrFrameData.pose.position)(t=this._devicePosition).set.apply(t,c(this._vrFrameData.pose.position));s.default.mat4_fromRotationTranslation(this._deviceWorldMatrix,this._deviceOrientation.toArray(),this._devicePosition.toArray()),this._vrDisplay.stageParameters&&this._vrDisplay.stageParameters.sittingToStandingTransform&&s.default.mat4_multiply(this._deviceWorldMatrix,this._vrDisplay.stageParameters.sittingToStandingTransform,this._deviceWorldMatrix),this._headPose._setPoseModelMatrix(this._deviceWorldMatrix),this._eyeLevelPose.position=this._devicePosition.toArray()}}}]),t}(i.default);t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=_(r(7)),a=_(r(1)),o=_(r(14)),s=_(r(21)),u=_(r(20)),l=_(r(0)),h=_(r(2)),c=_(r(5)),f=_(r(41)),d=_(r(9));_(r(10)),_(r(8));function _(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"Camera",!0,!0));return r._initialized=!1,r._running=!1,r._cameraFov=70*Math.PI/180,r._focalLength=160/Math.tan(r._cameraFov/2),r._cameraIntrinsics=[r._focalLength,0,0,0,r._focalLength,0,160,120,1],r._arKitWrapper=null,r._mediaStream=null,r._videoEl=null,r._arCoreCameraRenderer=null,r._arCoreCanvas=null,r._elContext=null,r._vrDisplay=null,r._vrFrameData=null,r._sendingVideo=!1,r._videoFramesPaused=!1,r._sendVideoFrame=!1,r._videoProjectionMatrix=l.default.mat4_generateIdentity(),r._videoViewMatrix=l.default.mat4_generateIdentity(),r._lightEstimate=new u.default,"function"==typeof navigator.getVRDisplays&&navigator.getVRDisplays().then((function(e){var t=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;if(null!==s&&s.capabilities.hasPassThroughCamera){if(r._vrDisplay=s,r._vrFrameData=new VRFrameData,!window.WebARonARKitSetData&&(r._arCoreCanvas=document.createElement("canvas"),r._xr._realityEls.appendChild(r._arCoreCanvas),r._arCoreCanvas.width=window.innerWidth,r._arCoreCanvas.height=window.innerHeight,r._elContext=r._arCoreCanvas.getContext("webgl"),null===r._elContext))throw"Could not create CameraReality GL context";break}}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}})),window.addEventListener("resize",(function(){r._arCoreCanvas&&(r._arCoreCanvas.width=window.innerWidth,r._arCoreCanvas.height=window.innerHeight),r._videoEl&&setTimeout((function(){r._adjustVideoSize()}),10)}),!1),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"_setFovy",value:function(e){this._cameraFov=e*Math.PI/180,this._videoEl?(this._videoRenderWidth>this._videoRenderHeight?this._focalLength=this._videoRenderWidth/2/Math.tan(this._cameraFov/2):this._focalLength=this._videoRenderHeight/2/Math.tan(this._cameraFov/2),this._cameraIntrinsics=[this._focalLength,0,0,0,this._focalLength,0,this._videoRenderWidth/2,this._videoRenderHeight/2,1]):this._focalLength=0}},{key:"_adjustVideoSize",value:function(){var e=this._videoRenderWidth,t=this._videoRenderHeight,r=e/t,n=this._videoEl.videoWidth,a=this._videoEl.videoHeight;if(n/a!=r){for(;n>512||a>512;)n/=2,a/=2;r=(e=this._videoRenderWidth=n)/(t=this._videoRenderHeight=a);this._videoFrameCanvas&&(this._videoFrameCanvas.width=n,this._videoFrameCanvas.height=a)}this._setFovy(this._cameraFov/(Math.PI/180));var o=this._xr._realityEls.clientWidth,s=this._xr._realityEls.clientHeight,u=o/s,l=0,h=0;r>u?(e=t*u,l=-((o=s*r)-this._xr._realityEls.clientWidth)/2):(t=e/u,h=-((s=o/r)-this._xr._realityEls.clientHeight)/2),this._videoEl.style.width=o.toFixed(2)+"px",this._videoEl.style.height=s.toFixed(2)+"px",this._videoEl.style.transform="translate("+l.toFixed(2)+"px, "+h.toFixed(2)+"px)";try{this.dispatchEvent(new CustomEvent(i.default.WINDOW_RESIZE_EVENT,{source:this,detail:{width:e,height:t,focalLength:this._focalLength}}))}catch(e){console.error("WINDOW_RESIZE_EVENT error",e)}}},{key:"_handleNewFrame",value:function(e){if(this._vrDisplay&&(this._arCoreCameraRenderer&&this._arCoreCameraRenderer.render(),this._vrDisplay.getFrameData(this._vrFrameData)),this._videoEl&&this._sendVideoFrame&&!this._videoFramesPaused){this._sendVideoFrame=!1;var t=this._videoRenderWidth,r=this._videoRenderHeight;this._videoCtx.drawImage(this._videoEl,0,0,t,r);var n=this._videoCtx.getImageData(0,0,t,r),a=(n.data,n.data.length,[{size:{width:t,height:r,bytesPerRow:4*t,bytesPerPixel:4},buffer:n}]),o=XRVideoFrame.IMAGEFORMAT_RGBA32,s=e.timestamp,u=e.views[0];l.default.mat4_invert(this._videoViewMatrix,u.viewMatrix),this._videoProjectionMatrix.set(u.projectionMatrix);var h={arCamera:!1,cameraOrientation:0,cameraIntrinsics:this._cameraIntrinsics.slice(0),cameraImageResolution:{width:this._videoEl.videoWidth,height:this._videoEl.videoHeight},viewMatrix:this._videoViewMatrix,projectionMatrix:this._videoProjectionMatrix},c=new XRVideoFrame(a,o,s,h);try{this.dispatchEvent(new CustomEvent(i.default.COMPUTER_VISION_DATA,{source:this,detail:c}))}catch(e){console.error("COMPUTER_VISION_DATA event error",e)}}}},{key:"_start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._running||(this._running=!0,null!==this._vrDisplay?(window.WebARonARKitSetData||(this._arCoreCameraRenderer=new f.default(this._vrDisplay,this._elContext)),this._initialized=!0):c.default.HasARKit()?!1===this._initialized?(this._initialized=!0,this._arKitWrapper=c.default.GetOrCreate(),this._arKitWrapper.addEventListener(c.default.WATCH_EVENT,this._handleARKitWatch.bind(this)),this._arKitWrapper.waitForInit().then((function(){e._arKitWrapper.watch(t)}))):this._arKitWrapper.watch(t):!1===this._initialized?(this._initialized=!0,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then((function(r){e._videoEl=document.createElement("video"),e._xr._realityEls.appendChild(e._videoEl),e._videoEl.setAttribute("class","camera-reality-video"),e._videoEl.setAttribute("playsinline",!0),e._videoEl.style.width="100%",e._videoEl.style.height="100%",e._videoEl.srcObject=r,e._videoEl.play(),e._setupWebRTC(t)})).catch((function(t){console.error("Could not set up video stream",t),e._initialized=!1,e._running=!1}))):this._videoEl&&(this._xr._realityEls.appendChild(this._videoEl),this._videoEl.play(),this._setupWebRTC(t)))}},{key:"_setupWebRTC",value:function(e){var t=this;e.videoFrames&&(this._sendingVideo=!0,this._videoEl.addEventListener("loadedmetadata",(function(){for(var e=t._videoEl.videoWidth,r=t._videoEl.videoHeight;e>256||r>256;)e/=2,r/=2;t._videoRenderWidth=e,t._videoRenderHeight=r,t._videoFrameCanvas=document.createElement("canvas"),t._videoFrameCanvas.width=e,t._videoFrameCanvas.height=r,t._videoCtx=t._videoFrameCanvas.getContext("2d"),t._adjustVideoSize(),t._sendVideoFrame=!0})))}},{key:"_requestVideoFrame",value:function(){this._sendVideoFrame=!0}},{key:"_stopVideoFrames",value:function(){this._videoFramesPaused=!0}},{key:"_startVideoFrames",value:function(){this._videoFramesPaused=!1}},{key:"_stop",value:function(){if(!1!==this._running)if(this._running=!1,c.default.HasARKit()){if(null===this._arKitWrapper)return;this._arKitWrapper.stop()}else this._arCoreCanvas?(this._xr._realityEls.removeChild(this._arCoreCanvas),this._arCoreCanvas=null):null!==this._videoEl&&(this._videoEl.pause(),this._xr._realityEls.removeChild(this._videoEl))}},{key:"_handleARKitWatch",value:function(e){if(e.detail&&e.detail.objects){var t=!0,r=!1,n=void 0;try{for(var a,o=e.detail.objects[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;this._updateAnchorFromARKitUpdate(s.uuid,s);try{this.dispatchEvent(new CustomEvent(i.default.UPDATE_WORLD_ANCHOR,{source:this,detail:s.uuid}))}catch(e){console.error("UPDATE_WORLD_ANCHOR event error",e)}}}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}}if(e.detail&&e.detail.removedObjects){var u=!0,l=!1,h=void 0;try{for(var c,f=e.detail.removedObjects[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value;try{this.dispatchEvent(new CustomEvent(i.default.REMOVE_WORLD_ANCHOR,{source:this,detail:d}))}catch(e){console.error("REMOVE_WORLD_ANCHOR event error",e)}this._deleteAnchorFromARKitUpdate(d)}}catch(e){l=!0,h=e}finally{try{!u&&f.return&&f.return()}finally{if(l)throw h}}}if(e.detail&&e.detail.newObjects){var _=!0,p=!1,v=void 0;try{for(var y,m=e.detail.newObjects[Symbol.iterator]();!(_=(y=m.next()).done);_=!0){var w=y.value;try{this.dispatchEvent(new CustomEvent(i.default.NEW_WORLD_ANCHOR,{source:this,detail:w}))}catch(e){console.error("NEW_WORLD_ANCHOR event error",e)}}}catch(e){p=!0,v=e}finally{try{!_&&m.return&&m.return()}finally{if(p)throw v}}}}},{key:"_deleteAnchorFromARKitUpdate",value:function(e){this._anchors.delete(e)}},{key:"_handleARKitAddObject",value:function(e){this._updateAnchorFromARKitUpdate(e.uuid,e)}},{key:"_updateAnchorFromARKitUpdate",value:function(e,t){var r=this._anchors.get(e)||null;if(null!==r)switch(r.coordinateSystem._relativeMatrix=t.transform,t.type){case c.default.ANCHOR_TYPE_PLANE:r.center=t.plane_center,r.extent=[t.plane_extent.x,t.plane_extent.z],r.alignment=t.plane_alignment,r.geometry=t.geometry;break;case c.default.ANCHOR_TYPE_FACE:t.geometry&&(r.geometry.vertices=t.geometry.vertices),t.blendShapes&&r.updateBlendShapes(t.blendShapes);break;case c.default.ANCHOR_TYPE_ANCHOR:case c.default.ANCHOR_TYPE_IMAGE:}}},{key:"_addAnchor",value:function(e,t){var r=this;return null!==this._arKitWrapper&&this._arKitWrapper.addAnchor(e.uid,e.coordinateSystem._poseModelMatrix).then((function(e){return r._handleARKitAddObject(e)})),this._anchors.set(e.uid,e),e.uid}},{key:"_findAnchor",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise((function(u,f){if(null!==n._arKitWrapper)n._arKitWrapper.hitTest(e,t,i||c.default.HIT_TEST_TYPE_EXISTING_PLANES).then((function(e){if(0!==e.length){var t=n._pickARKitHit(e);if(t.anchor_transform){t.anchor_transform[13]+=o.default.SITTING_EYE_HEIGHT,t.world_transform[13]+=o.default.SITTING_EYE_HEIGHT;var i=n._getAnchor(t.uuid);if(null===i){var c=new XRCoordinateSystem(r,XRCoordinateSystem.TRACKER);c._relativeMatrix=t.anchor_transform,i=new a.default(c,t.uuid),n._anchors.set(i.uid,i)}var f=[t.world_transform[12]-t.anchor_transform[12],t.world_transform[13]-t.anchor_transform[13],t.world_transform[14]-t.anchor_transform[14]],d=(new h.default).setFromRotationMatrix(t.world_transform),_=(new h.default).setFromRotationMatrix(t.anchor_transform).inverse(),p=(new h.default).multiplyQuaternions(d,_),v=new s.default(i.uid);v.poseMatrix=l.default.mat4_fromRotationTranslation(new Float32Array(16),p.toArray(),f),u(v)}else{var y=new XRCoordinateSystem(r,XRCoordinateSystem.TRACKER);y._relativeMatrix=t.world_transform;var m=new a.default(y,t.uuid);n._anchors.set(m.uid,m);var w=new s.default(m.uid);u(w)}}else u(null)}));else if(null!==n._vrDisplay){var d=n._vrDisplay.hitTest(e,t);if(0==d.length)return void u(null);d.sort((function(e,t){return e.distance-t.distance}));var _=n._getAnchor(d[0].uuid);if(null===_){var p=new XRCoordinateSystem(r,XRCoordinateSystem.TRACKER);p._relativeMatrix=d[0].modelMatrix,p._relativeMatrix[13]+=o.default.SITTING_EYE_HEIGHT,_=new a.default(p),n._anchors.set(_.uid,_)}u(new s.default(_.uid))}else u(null)}))}},{key:"_createImageAnchor",value:function(e,t,r,n,i){return this._arKitWrapper?this._arKitWrapper.createImageAnchor(e,t,r,n,i):null}},{key:"_activateDetectionImage",value:function(e,t){var r=this;return new Promise((function(n,i){r._arKitWrapper?r._arKitWrapper.activateDetectionImage(e).then((function(e){if(!0===e.activated){var a=new XRCoordinateSystem(t,XRCoordinateSystem.TRACKER);a._relativeMatrix=e.imageAnchor.transform;var o=new d.default(a,e.imageAnchor.uuid);r._anchors.set(e.imageAnchor.uuid,o),n(e.imageAnchor.transform)}else null!==e.error?i(e.error):i(null)})):i("ARKit not supported")}))}},{key:"_removeAnchor",value:function(e){this._arKitWrapper?this._arKitWrapper.removeAnchor(e):this._getAnchor(e)&&this._anchors.delete(e)}},{key:"_pickARKitHit",value:function(e){if(0===e.length)return null;var t=e.filter((function(e){return e.type!=c.default.HIT_TEST_TYPE_FEATURE_POINT})),r=t.filter((function(e){return e.type==c.default.HIT_TEST_TYPE_EXISTING_PLANE_USING_EXTENT})),n=t.filter((function(e){return e.type==c.default.HIT_TEST_TYPE_EXISTING_PLANE}));return r.length?(r=r.sort((function(e,t){return e.distance-t.distance})))[0]:n.length?(n=n.sort((function(e,t){return e.distance-t.distance})))[0]:t.length?(t=t.sort((function(e,t){return e.distance-t.distance})))[0]:e[0]}},{key:"_hitTestNoAnchor",value:function(e,t,r){if(null!==this._arKitWrapper){for(var n=this._arKitWrapper.hitTestNoAnchor(e,t),i=0;i<n.length;i++)n[i].modelMatrix[13]+=o.default.SITTING_EYE_HEIGHT;return 0==n.length?null:n}if(null!==this._vrDisplay){for(var a=this._vrDisplay.hitTest(e,t),s=0;s<a.length;s++)a[s].modelMatrix[13]+=o.default.SITTING_EYE_HEIGHT;return 0==a.length?null:a}return null}},{key:"_getHasLightEstimate",value:function(){return null!==this._arKitWrapper}},{key:"_getLightAmbientIntensity",value:function(){return null!==this._arKitWrapper?(this._lightEstimate.ambientIntensity=this._arKitWrapper.lightIntensity,this._lightEstimate.ambientIntensity):null}},{key:"_getWorldMappingStatus",value:function(){return null!==this._arKitWrapper?this._arKitWrapper.worldMappingStatus:null}},{key:"_getWorldMap",value:function(){var e=this;return new Promise((function(t,r){e._arKitWrapper?e._arKitWrapper.getWorldMap().then((function(e){!0===e.saved?t(e.worldMap):null!==e.error?r(e.error):r(null)})):r("ARKit not supported")}))}},{key:"_setWorldMap",value:function(e){return this._arKitWrapper?this._arKitWrapper.setWorldMap(e):new Promise((function(e,t){t(new Error("setWorldMap not supported"))}))}},{key:"_getTimeStamp",value:function(e){return null!==this._arKitWrapper?this._arKitWrapper.timestamp:e}},{key:"_findFloorAnchor",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(e,t){e(null)}))}}]),t}(i.default);t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a="#extension GL_OES_EGL_image_external : require\n\nprecision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform samplerExternalOES uSampler;\n\nvoid main(void) {\n  gl_FragColor = texture2D(uSampler, vTextureCoord);\n}",o="attribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n  gl_Position = vec4(aVertexPosition, 1.0);\n  vTextureCoord = aTextureCoord;\n}";function s(e,t,r){if("fragment"==r)var n=e.createShader(e.FRAGMENT_SHADER);else{if("vertex"!=r)return null;n=e.createShader(e.VERTEX_SHADER)}return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.error(e.getShaderInfoLog(n)),null)}function u(e,t){var r=0;switch(t){case 90:r=1;break;case 180:r=2;break;case 270:r=3;break;default:r=0}var n=0;switch(e){case 90:n=1;break;case 180:n=2;break;case 270:n=3;break;default:n=0}var i=n-r;return i<0&&(i+=4),i%4}var l=function(){function e(t,r){i(this,e),this.vrDisplay=t,this.gl=r,this.passThroughCamera=t.getPassThroughCamera(),this.program=function(e,t,r){var n=s(e,t,"vertex"),i=s(e,r,"fragment");if(!i)return null;var a=e.createProgram();return e.attachShader(a,n),e.attachShader(a,i),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||console.error("Could not initialise arview shaders"),a}(r,o,a),r.useProgram(this.program),this.vertexPositionAttribute=r.getAttribLocation(this.program,"aVertexPosition"),this.textureCoordAttribute=r.getAttribLocation(this.program,"aTextureCoord"),this.samplerUniform=r.getUniformLocation(this.program,"uSampler"),this.vertexPositionBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.vertexPositionBuffer);var n=new Float32Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0]);r.bufferData(r.ARRAY_BUFFER,n,r.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=12,this.textureCoordBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.textureCoordBuffer);var l=null;if(this.vrDisplay){var h=this.passThroughCamera.width/this.passThroughCamera.textureWidth,c=this.passThroughCamera.height/this.passThroughCamera.textureHeight;l=[[0,0,0,c,h,0,h,c],[h,0,0,0,h,c,0,c],[h,c,h,0,0,c,0,0],[0,c,h,c,0,0,h,0]]}else l=[[0,0,0,1,1,0,1,1],[1,0,0,0,1,1,0,1],[1,1,1,0,0,1,0,0],[0,1,1,1,0,0,1,0]];this.f32TextureCoords=[];for(var f=0;f<l.length;f++)this.f32TextureCoords.push(new Float32Array(l[f]));this.combinedOrientation=u(screen.orientation.angle,this.passThroughCamera.orientation),r.bufferData(r.ARRAY_BUFFER,this.f32TextureCoords[this.combinedOrientation],r.STATIC_DRAW),this.textureCoordBuffer.itemSize=2,this.textureCoordBuffer.numItems=8,r.bindBuffer(r.ARRAY_BUFFER,null),this.indexBuffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var d=new Uint16Array([0,1,2,2,1,3]);return r.bufferData(r.ELEMENT_ARRAY_BUFFER,d,r.STATIC_DRAW),this.indexBuffer.itemSize=1,this.indexBuffer.numItems=6,r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),this.texture=r.createTexture(),r.useProgram(null),this.projectionMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.mvMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this}return n(e,[{key:"render",value:function(){var e=this.gl;e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.enableVertexAttribArray(this.vertexPositionAttribute),e.vertexAttribPointer(this.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.textureCoordBuffer);var t=u(screen.orientation.angle,this.passThroughCamera.orientation);t!==this.combinedOrientation&&(this.combinedOrientation=t,e.bufferData(e.ARRAY_BUFFER,this.f32TextureCoords[this.combinedOrientation],e.STATIC_DRAW)),e.enableVertexAttribArray(this.textureCoordAttribute),e.vertexAttribPointer(this.textureCoordAttribute,this.textureCoordBuffer.itemSize,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_EXTERNAL_OES,this.texture),e.texImage2D(e.TEXTURE_EXTERNAL_OES,0,e.RGB,e.RGB,e.UNSIGNED_BYTE,this.passThroughCamera),e.uniform1i(this.samplerUniform,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.drawElements(e.TRIANGLES,this.indexBuffer.numItems,e.UNSIGNED_SHORT,0),e.bindTexture(e.TEXTURE_EXTERNAL_OES,null),e.disableVertexAttribArray(this.vertexPositionAttribute),e.disableVertexAttribArray(this.textureCoordAttribute),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.useProgram(null)}}]),e}(),h=function(){function e(t,r){i(this,e),this.vrDisplay=t,this.gl=r,this.videoRenderer=new l(t,this.gl),this.width=window.innerWidth,this.height=window.innerHeight,window.addEventListener("resize",this.onWindowResize.bind(this),!1)}return n(e,[{key:"onWindowResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight}},{key:"render",value:function(){var e=this.gl,t=1*this.width,r=1*this.height;e.viewportWidth!==t&&(e.viewportWidth=t),e.viewportHeight!==r&&(e.viewportHeight=r),this.gl.viewport(0,0,e.viewportWidth,e.viewportHeight),this.videoRenderer.render()}}]),e}();t.default=h}]),XRDisplay=window.XRDisplay,XRSession=window.XRSession,XRSessionCreateParameters=window.XRSessionCreateParameters,Reality=window.Reality,XRPointCloud=window.XRPointCloud,XRLightEstimate=window.XRLightEstimate,XRAnchor=window.XRAnchor,XRPlaneAnchor=window.XRPlaneAnchor,XRFaceAnchor=window.XRFaceAnchor,XRImageAnchor=window.XRImageAnchor,XRAnchorOffset=window.XRAnchorOffset,XRStageBounds=window.XRStageBounds,XRStageBoundsPoint=window.XRStageBoundsPoint,XRPresentationFrame=window.XRPresentationFrame,XRView=window.XRView,XRViewport=window.XRViewport,XRCoordinateSystem=window.XRCoordinateSystem,XRViewPose=window.XRViewPose,XRLayer=window.XRLayer,XRWebGLLayer=window.XRWebGLLayer,XRVideoFrame=window.XRVideoFrame},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return n}));class n{constructor(e,t=!0,r=!0,n=!1,i=!1,a=!0){if(this.el=e,this.createVirtualReality=t,this.shouldStartPresenting=r,this.useComputerVision=n,this.alignEUS=a,this.worldSensing=i,this._boundHandleFrame=this._handleFrame.bind(this),this.displays=null,this.display=null,this.session=null,this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(70,1024,1024,.1,1e3),this.scene.add(this.camera),this.glCanvas=document.createElement("canvas"),this.glContext=this.glCanvas.getContext("webgl"),null===this.glContext)throw this.showMessage("Could not create a WebGL canvas"),new Error("Could not create GL context");this.renderer=new THREE.WebGLRenderer({canvas:this.glCanvas,context:this.glContext,antialias:!1,alpha:!0}),this.renderer.setPixelRatio(1),this.renderer.autoClear=!1,this.renderer.setClearColor("#000",0),this.requestedFloor=!1,this.floorGroup=new THREE.Group,this.anchoredNodes=[],this.initializeScene(),void 0!==navigator.XR?navigator.XR.getDisplays().then(e=>{0!=e.length?(this.displays=e,this._startSession()):this.showMessage("No displays are available")}).catch(e=>{console.error("Error getting XR displays",e),this.showMessage("Could not get XR displays")}):this.showMessage("No WebXR API found, usually because the WebXR polyfill has not loaded")}_startSession(){let e={exclusive:this.createVirtualReality,type:this.createVirtualReality?XRSession.REALITY:XRSession.AUGMENTATION,videoFrames:this.useComputerVision,alignEUS:this.alignEUS,worldSensing:this.worldSensing};for(let t of this.displays)if(t.supportsSession(e)){this.display=t;break}null!==this.display?this.display.requestSession(e).then(e=>{this.session=e,this.session.depthNear=.1,this.session.depthFar=1e3,this.session.addEventListener("focus",e=>{this.handleSessionFocus(e)}),this.session.addEventListener("blur",e=>{this.handleSessionBlur(e)}),this.session.addEventListener("end",e=>{this.handleSessionEnded(e)}),this.newSession(),this.shouldStartPresenting&&this.startPresenting()}).catch(e=>{console.error("Error requesting session",e),this.showMessage("Could not initiate the session")}):this.showMessage("Could not find a display for this type of session")}newSession(){}showMessage(e){let t,r=document.getElementsByClassName("common-message");r.length>0?t=r[0]:((t=document.createElement("div")).setAttribute("class","common-message"),this.el.append(t));let n=document.createElement("div");n.innerHTML=e,t.appendChild(n)}startPresenting(){if(null===this.session)throw this.showMessage("Can not start presenting without a session"),new Error("Can not start presenting without a session");this.session.baseLayer=new XRWebGLLayer(this.session,this.glContext),this.session.baseLayer.addEventListener("focus",e=>{this.handleLayerFocus(e)}),this.session.baseLayer.addEventListener("blur",e=>{this.handleLayerBlur(e)}),this.session.requestFrame(this._boundHandleFrame)}handleSessionFocus(e){}handleSessionBlur(e){}handleSessionEnded(e){}handleLayerFocus(e){}handleLayerBlur(e){}setVideoWorker(e){this.session.setVideoFrameHandler(e)}requestVideoFrame(){this.session.requestVideoFrame()}initializeScene(){}updateScene(e){}_handleFrame(e){this.session.requestFrame(this._boundHandleFrame),e.getDisplayPose(e.getCoordinateSystem(XRCoordinateSystem.HEAD_MODEL));!1===this.requestedFloor&&(this.requestedFloor=!0,e.findFloorAnchor("first-floor-anchor").then(t=>{if(null===t){console.log("could not find the floor anchor");const r=e.getCoordinateSystem(XRCoordinateSystem.EYE_LEVEL),n=e.addAnchor(r,[0,-1,0]);t=new XRAnchorOffset(n)}this.addAnchoredNode(t,this.floorGroup)}).catch(e=>{console.error("error finding the floor anchor",e)}));for(let t of this.anchoredNodes)this.updateNodeFromAnchorOffset(e,t.node,t.anchorOffset);this.updateScene(e),this.renderer.autoClear=!1,this.renderer.setSize(this.session.baseLayer.framebufferWidth,this.session.baseLayer.framebufferHeight,!1),this.renderer.clear(),this.camera.matrixAutoUpdate=!1;for(const t of e.views){this.camera.matrix.fromArray(t.viewMatrix),this.camera.updateMatrixWorld(),this.camera.projectionMatrix.fromArray(t.projectionMatrix),this.renderer.clearDepth();const e=t.getViewport(this.session.baseLayer);this.renderer.setViewport(e.x,e.y,e.width,e.height),this.doRender()}}doRender(){this.renderer.render(this.scene,this.camera)}addAnchoredNode(e,t){this.anchoredNodes.push({anchorOffset:e,node:t}),this.scene.add(t)}removeAnchoredNode(e){for(var t=0;t<this.anchoredNodes.length;t++)if(e===this.anchoredNodes[t].node)return this.anchoredNodes.splice(t,1),void this.scene.remove(e)}anchoredNodeRemoved(e){}updateNodeFromAnchorOffset(e,t,r){const n=e.getAnchor(r.anchorUID);if(null===n)return throttledConsoleLog("Unknown anchor uid",r.anchorUID),this.anchoredNodeRemoved(t),void this.removeAnchoredNode(t);t.matrixAutoUpdate=!1,t.matrix.fromArray(r.getOffsetTransform(n.coordinateSystem)),t.updateMatrixWorld(!0)}}e.throttle=function(e,t,r=!0,n=!0){var i,a,o,s,u=0,l=function(){u=!1===r?0:Date.now(),i=null,s=e.apply(a,o),i||(a=o=null)},h=function(){var h=Date.now();u||!1!==r||(u=h);var c=t-(h-u);return a=this,o=arguments,c<=0||c>t?(i&&(clearTimeout(i),i=null),u=h,s=e.apply(a,o),i||(a=o=null)):i||!1===n||(i=setTimeout(l,c)),s};return h.cancel=function(){clearTimeout(i),u=0,i=a=o=null},h},e.throttledConsoleLog=throttle((...e)=>{console.log(...e)},1e3),e.hideMe=e=>{e.style.display="none"}}).call(this,r(2))}]]);